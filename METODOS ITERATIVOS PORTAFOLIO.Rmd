---
title: " Métodos iterativos"
author: "Aguirre Alvarado Danna Paola"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 6
    code_folding: show
    #theme: flatly
    theme: journal
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Sistemas de punto flotante

### Historia de los metodos numericos

 "Historia de los Métodos Numéricos y la Computación
Los métodos numéricos son procesos matemáticos iterativos diseñados para encontrar la aproximación a una solución específica con un nivel de error predefinido. Estos métodos se basan en la corrección repetida de un valor inicial (una iteración) hasta que la diferencia entre aproximaciones sucesivas se ajusta al error deseado, permitiendo resolver problemas sin recurrir a la matemática analítica exacta. La historia de los métodos numéricos está intrínsecamente ligada al desarrollo de herramientas para facilitar el cálculo, culminando en la invención de la computadora.

La búsqueda de soluciones aproximadas a problemas matemáticos complejos data de la antigüedad. Ya en 1650 a.C., los Papiros de Rhynd egipcios documentaban un método para resolver expresiones sin el uso del álgebra. Más tarde, alrededor del 250 a.C., Euclides desarrolló el Método de Exhaustión para aproximar el valor de pi mediante la inscripción consecutiva de figuras geométricas dentro de un círculo, un claro precursor de las técnicas de aproximación numérica.
Un hito crucial se dio en el Siglo IX d.C. con Al Juarismi, cuya obra no solo dio origen al término álgebra sino que también sentó las bases para el concepto de algoritmo, esencial para cualquier proceso numérico.

El desarrollo de herramientas y conceptos que simplificarían las extenuantes operaciones manuales fue clave en el período pre-computacional. En 1623, John Napier inventó los huesos de Napier, arreglos tabulares de logaritmos que simplificaban multiplicaciones y divisiones. En el Siglo XVII, Isaac Newton contribuyó con los procesos de interpolación polinomial. El Siglo XVIII marcó una era fundamental con Leibnitz y la creación del Cálculo diferencial, y Euler en 1768, quien generó soluciones aproximadas a ecuaciones diferenciales a través del principio de la integración numérica. Ese mismo año, Jacob Stirling y Brook Taylor presentaron el Cálculo de diferencias finitas, otra técnica fundamental en los métodos numéricos.
Antes de la computación electrónica, las iteraciones de los métodos numéricos eran realizadas manualmente por grupos de calculistas. Este proceso era extenuante y lento.


A partir de la mitad del Siglo XIX, la historia de los métodos numéricos se vuelve paralela a la historia de la computación. En 1822, Charles Babbage concibió la Máquina diferencial, una calculadora mecánica para funciones polinomiales. En 1843, Ada, condesa de Lovelace, publicó notas sobre la Máquina analítica de Babbage, siendo considerada por muchos la primera programadora al visualizar cómo la máquina podría ir más allá del cálculo numérico puro.
Avances clave en la organización y automatización del cálculo incluyeron:
  (1890) La empresa que se convertiría en IBM tabula el censo estadounidense usando las máquinas de tarjetas perforadas de Herman Hollerith.
  (1931) Vannebar Bush diseñó el analizador diferencial, un computador analógico electromecánico.
  (1937) Alan Turing publicó Sobre los números computables, describiendo un computador universal, mientras Howard Aiken proponía la construcción de un gran computador (Mark I) y John Vincent Atanasoff conceptualizaba el computador electrónico.
La Segunda Guerra Mundial impulsó el desarrollo de computadoras como el EDVAC (cuyo informe fue redactado por John Von Neumann en 1944) en Estados Unidos, aplicadas secretamente al cálculo balístico (solución de ecuaciones diferenciales).

El siglo XX vio la explosión de la computación, lo que permitió la aplicación práctica masiva de los métodos numéricos.
 (1953) John W. Backus de IBM desarrolló FORTRAN (Formulae Translating), el primer lenguaje de programación de alto nivel diseñado para el cálculo científico. Este lenguaje se convirtió en el lingua franca para la implementación de métodos numéricos.
 (1950) J.H. Wilkinson en el Reino Unido construyó la ACE (Automatic Computing Engine) para resolver cálculos con matrices, esenciales en muchas aplicaciones de métodos numéricos.
 (1970) La traducción de códigos de ALGOL para obtener eigenvalores (planteados por Wilkinson) dio origen a librerías de software fundamentales como EISPACK (1976) y LINPACK (1976). Estas librerías estandarizaron la solución de problemas de álgebra lineal numérica.
 (1986) Cleve Moler, utilizando EISPACK y LINPACK, creó MATLAB, un entorno de computación numérica de alta popularidad. Esto culminó en la fundación de la empresa MathWorks. 
Las contribuciones más recientes se centran en la creación de software robusto que minimiza los errores y mejora las aproximaciones de los resultados. Nombres como Katherine Johnson, Dorothy Vaughan, Mary Jackson, y Margaret Hamilton en la misión Apolo 11, entre otras, destacaron el rol fundamental de la programación y el cálculo riguroso en los logros científicos y de ingeniería.
Desde sus raíces antiguas, los métodos numéricos han evolucionado de procesos manuales extenuantes a sofisticados algoritmos de software, permitiendo la solución rápida y precisa de problemas científicos y de ingeniería que son inabordables por métodos analíticos."

## Conversion de base 10 a base 2

##### Convertir los siguientes numeros de base 10 a base 2.

#### a) 246

```{r}
numero_decimal <- 246
bits_completos <- intToBits(numero_decimal)

print(bits_completos)

binario_limpio <- paste(
  rev(as.integer(bits_completos)[1:8]), 
  collapse = ""
)

primer_uno <- regexpr("1", binario_limpio)

resultado_final <- substr(binario_limpio, primer_uno, nchar(binario_limpio))

cat("El número", numero_decimal, "en base 10 es:", resultado_final, "en base 2.\n")
```

#### b) 345.68

```{r}
numero_decimal <- 345.68

# --- Conversión de la Parte Entera (345) ---
parte_entera <- floor(numero_decimal)

dec_a_bin_entero <- function(n) {
  if (n == 0) return("0")
  binario <- ""
  while (n > 0) {
    binario <- paste0(n %% 2, binario)
    n <- n %/% 2
  }
  return(binario)
}

binario_entero <- dec_a_bin_entero(parte_entera)

# --- Conversión de la Parte Fraccionaria (0.68) ---
parte_fraccionaria <- numero_decimal - parte_entera
precisión <- 15 
binario_fraccionario <- ""
temp_frac <- parte_fraccionaria

for (i in 1:precisión) {
  temp_frac <- temp_frac * 2
  bit <- floor(temp_frac)
  binario_fraccionario <- paste0(binario_fraccionario, bit)
  temp_frac <- temp_frac - bit
  
  if (temp_frac == 0) {
    break
  }
}
  
resultado_binario <- paste0(binario_entero, ".", binario_fraccionario)

print(paste("Número Decimal:", numero_decimal))
print(paste("Parte Entera Binaria:", binario_entero))
print(paste("Parte Fraccionaria Binaria:", binario_fraccionario))
print(paste("Resultado Final en Base 2:", resultado_binario))
```

#### c) 4586632.2846

```{r}
numero_decimal <-4586632.2846 

# --- Conversión de la Parte Entera (345) ---
parte_entera <- floor(numero_decimal)

dec_a_bin_entero <- function(n) {
  if (n == 0) return("0")
  binario <- ""
  while (n > 0) {
    binario <- paste0(n %% 2, binario)
    n <- n %/% 2
  }
  return(binario)
}

binario_entero <- dec_a_bin_entero(parte_entera)

# --- Conversión de la Parte Fraccionaria (0.68) ---
parte_fraccionaria <- numero_decimal - parte_entera
precisión <- 15 
binario_fraccionario <- ""
temp_frac <- parte_fraccionaria

for (i in 1:precisión) {
  temp_frac <- temp_frac * 2
  bit <- floor(temp_frac)
  binario_fraccionario <- paste0(binario_fraccionario, bit)
  temp_frac <- temp_frac - bit
  
  if (temp_frac == 0) {
    break
  }
}
  
resultado_binario <- paste0(binario_entero, ".", binario_fraccionario)

print(paste("Número Decimal:", numero_decimal))
print(paste("Parte Entera Binaria:", binario_entero))
print(paste("Parte Fraccionaria Binaria:", binario_fraccionario))
print(paste("Resultado Final en Base 2:", resultado_binario))
```

#### d) 984365.27463

```{r}
numero_decimal <-984365.27463

# --- Conversión de la Parte Entera (345) ---
parte_entera <- floor(numero_decimal)

dec_a_bin_entero <- function(n) {
  if (n == 0) return("0")
  binario <- ""
  while (n > 0) {
    binario <- paste0(n %% 2, binario)
    n <- n %/% 2
  }
  return(binario)
}

binario_entero <- dec_a_bin_entero(parte_entera)

# --- Conversión de la Parte Fraccionaria (0.68) ---
parte_fraccionaria <- numero_decimal - parte_entera
precisión <- 15 
binario_fraccionario <- ""
temp_frac <- parte_fraccionaria

for (i in 1:precisión) {
  temp_frac <- temp_frac * 2
  bit <- floor(temp_frac)
  binario_fraccionario <- paste0(binario_fraccionario, bit)
  temp_frac <- temp_frac - bit
  
  if (temp_frac == 0) {
    break
  }
}
  
resultado_binario <- paste0(binario_entero, ".", binario_fraccionario)

print(paste("Número Decimal:", numero_decimal))
print(paste("Parte Entera Binaria:", binario_entero))
print(paste("Parte Fraccionaria Binaria:", binario_fraccionario))
print(paste("Resultado Final en Base 2:", resultado_binario))
```

#### e) 79905523
```{r}
numero_base10 <- 79905523
bits_vector <- intToBits(numero_base10)

bits_revertidos <- rev(as.integer(bits_vector))

primer_uno <- match(1, bits_revertidos)

if (!is.na(primer_uno)) {
  binario_vector <- bits_revertidos[primer_uno:length(bits_revertidos)]
} else {
  
  binario_vector <- 0
}

binario_cadena <- paste(binario_vector, collapse = "")

cat("Número en base 2:", binario_cadena, "\n")
```


![Ejercicio de base dos](Base dos.jpeg){width=505}


#### Describe exhaustivamente los tipos de errores que existen

I. Errores Fundamentales y de Origen
1. Errores Inherentes (E_{inh})
Son los errores que residen en los datos de entrada del problema, independientes del método numérico empleado.
 * Definición: Imperfecciones en los valores iniciales debido a la naturaleza de su obtención.
 * Causas Primarias:
   * Imprecisión en la Medición: Limitaciones instrumentales en la obtención de datos empíricos.
   * Representación Irreversible: Necesidad de truncar o redondear constantes irracionales (\pi, e) o fracciones no periódicas para su almacenamiento en formato de coma flotante.
   
2. Errores por Redondeo (E_{red})
Ocurren debido a la arquitectura de la máquina, específicamente la precisión finita de la aritmética de coma flotante.
 * Definición: Discrepancia resultante de almacenar un número con una mantisa y un exponente limitados.
 * Mecanismos de Generación:
   * Corte (Chopping): Descartar los dígitos menos significativos.
   * Ajuste Simétrico (Rounding): Ajustar el último dígito retenido basándose en el valor del primer dígito descartado.
 * Problemas Asociados:
   * Cancelación Sustractiva: Pérdida de cifras significativas al restar dos números casi idénticos. Esto magnifica el error relativo, ya que la diferencia resultante está dominada por el error de redondeo inicial.
   
II. Errores de Metodología y Procedimiento
3. Errores por Truncamiento (E_{trc})
Surgen de la aproximación de un proceso matemático infinito o continuo mediante un procedimiento discreto y finito.
 * Definición: El error introducido al reemplazar una función o un operador exacto con una fórmula de aproximación finita.
 * Ejemplos Canónicos:
   * Series Infinitas: Interrupción de una Serie de Taylor o Maclaurin en un número finito de términos. El error es igual a la suma de los términos omitidos (el término restante).
   * Integración Numérica: Uso de fórmulas como la regla del trapecio o la regla de Simpson en lugar de la integración analítica.
   * Diferenciación Numérica: Reemplazo de la derivada por una aproximación de diferencias finitas (e.g., diferencia progresiva, regresiva, o central).
El error de truncamiento se puede estimar analíticamente y, en general, se reduce al aumentar el número de iteraciones o al disminuir el tamaño del paso (h).


4. Errores de Formulación (o de Modelo) (E_{mod})
Se deben a las simplificaciones inherentes en la traducción de un fenómeno físico a un modelo matemático.
 * Definición: Discrepancia entre el sistema real y el sistema descrito por las ecuaciones utilizadas.
 * Ejemplo: Un modelo que asume que la Tierra es perfectamente esférica o que desprecia la fricción o la resistencia del aire.
III. Interacción y Propagación de Errores
5. Errores Propagados (E_{prp})
Resultan de la acumulación y transferencia de errores (inherentes, de redondeo, o de truncamiento) a lo largo de las etapas iterativas de un algoritmo.
 * Conceptos Clave:
   * Estabilidad de un Método: Un método es numéricamente estable si los errores generados en cualquier etapa se mantienen acotados (no crecen exponencialmente).
   * Condicionamiento de un Problema: Mide la sensibilidad del resultado de un problema a los cambios o errores en los datos de entrada. Un problema está mal condicionado si pequeños errores en la entrada producen grandes errores en la salida.
Métrica del Error (Definiciones Formales)
Sea V el valor verdadero exacto y V^* el valor aproximado calculado.
 * Error Absoluto (E_a):
   
   
   Indica la magnitud bruta del error, pero no su significado en relación con el tamaño del valor.
 * Error Relativo (E_r):Es una métrica superior de la precisión, ya que normaliza el error con respecto al valor real. El error relativo porcentual se define como E_r \times 100\%."


# Sistemas de Ecuaciones lineales

## Metodos Directos

### Gauss simple

####  Ejercicio 1.
 x1−2x2+0.5x3 = −5
 −2x1+5x2−1.5x3 = 0
 −0.2x1+1.75x2−x3 = 10

```{r}
A <- matrix(c(1, -2, 0.5,-2, 5, -1.5,-0.2, 1.75, -1), nrow = 3, byrow = TRUE)
```

```{r}
b <- matrix(c(-5, 0, 10), nrow = 3)
```

```{r}
Ab <- cbind(A, b)
cat("Matriz aumentada inicial:\n")
print(Ab)
```

```{r}
m21 <- -Ab[2,1] / Ab[1,1]
m31 <- -Ab[3,1] / Ab[1,1]

Ab[2,] <- Ab[2,] + m21 * Ab[1,]
Ab[3,] <- Ab[3,] + m31 * Ab[1,]

cat("\nDespués de eliminar columna 1:\n")
print(Ab)
```

```{r}
m32 <- -Ab[3,2] / Ab[2,2]

Ab[3,] <- Ab[3,] + m32 * Ab[2,]

cat("\nDespués de eliminar columna 2:\n")
print(Ab)
```

```{r}
z <- Ab[3,4] / Ab[3,3] 
y <- (Ab[2,4] - Ab[2,3] * z) / Ab[2,2] 
x <- (Ab[1,4] - Ab[1,2] * y - Ab[1,3] * z) / Ab[1,1]
```

```{r}
cat("\n--- Solución del sistema ---\n")
cat("x =", x, "\n") 
cat("y =", y, "\n") 
cat("z =", z, "\n")
```

#### Ejecicio 2.
 3x1−x2+6x4 = 2.3
 4x1+2x2−x3−5x4 = 6.9
 −5x1+x2−3x3 = −36
 10x2−4x3+7x4 = −36

```{r}
A <- matrix(c(3, -1, 0, 6,4, 2, -1, -5,-5, 1, -3, 0,0, 10, -4, 7),   
            nrow = 4, byrow = TRUE)
```

```{r}
b <- matrix(c(2.3, 6.9, -36, -36), nrow = 4)
```

```{r}
Ab <- cbind(A, b)
cat("Matriz aumentada inicial (4x5):\n")
print(Ab)
```

```{r}
m21 <- -Ab[2,1] / Ab[1,1]
m31 <- -Ab[3,1] / Ab[1,1]
m41 <- -Ab[4,1] / Ab[1,1] 

Ab[2,] <- Ab[2,] + m21 * Ab[1,]
Ab[3,] <- Ab[3,] + m31 * Ab[1,]
Ab[4,] <- Ab[4,] + m41 * Ab[1,] 

cat("\nDespués de eliminar columna 1:\n")
print(Ab)
```
```{r}
m32 <- -Ab[3,2] / Ab[2,2]

Ab[3,] <- Ab[3,] + m32 * Ab[2,]

cat("\nDespués de eliminar columna 2:\n")
print(Ab)
```

```{r}
m43 <- -Ab[4,3] / Ab[3,3] 

Ab[4,] <- Ab[4,] + m43 * Ab[3,] 

cat("\nDespués de eliminar columna 3 (Matriz Triangular Superior):\n")
print(Ab)
```

```{r}
x4 <- Ab[4,5] / Ab[4,4]
```

```{r}
x3 <- (Ab[3,5] - Ab[3,4] * x4) / Ab[3,3] 
```

```{r}
x2 <- (Ab[2,5] - Ab[2,3] * x3 - Ab[2,4] * x4) / Ab[2,2]
```

```{r}
x1 <- (Ab[1,5] - Ab[1,2] * x2 - Ab[1,3] * x3 - Ab[1,4] * x4) / Ab[1,1]
```

```{r}
cat("\n--- Solución del sistema ---\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
cat("x3 =", x3, "\n")
cat("x4 =", x4, "\n")
```


#### Ejercicio 3.Utilizar redondeo a 4 cifras significativas.
 0.003000x1+59.14x2 = 59.17
 5.291x1−6.130x2 = 46.78

```{r}
redondeo <- function(num) {
  return(signif(num, digits = 4))
}
```

```{r}
A <- matrix(c(0.003000, 59.14, 5.291,-6.130), nrow = 2, byrow = TRUE)
```

```{r}
b <- matrix(c(59.17,46.78), nrow = 2)
```

```{r}
Ab <- cbind(A, b)
cat("### Matriz aumentada inicial ###\n")
print(Ab)

```

```{r}
m21 <- -Ab[2,1] / Ab[1,1]
m21 <- redondeo(m21) 
cat("Multiplicador m21 (redondeado) =", m21, "\n")
```

```{r}
m21_F1 <- numeric(3)
for (j in 1:3) {
  m21_F1[j] <- redondeo(m21 * Ab[1, j]) 
}
cat("m21 * F1 (productos redondeados) =", m21_F1, "\n")

  Ab[2, j] <- redondeo(Ab[2, j] + m21_F1[j]) 
```

```{r}
cat("### Matriz después de la Eliminación ###\n")
print(Ab)
```

```{r}
x2 <- Ab[2, 3] / Ab[2, 2]
x2 <- redondeo(x2) 
cat("Cálculo de x2 (", Ab[2, 3], "/", Ab[2, 2], "): x2 =", x2, "\n")
```

```{r}
a12_x2 <- Ab[1, 2] * x2
a12_x2 <- redondeo(a12_x2) 
cat("Cálculo a12*x2 (redondeado) =", a12_x2, "\n")
```

```{r}
numerador_x1 <- Ab[1, 3] - a12_x2
numerador_x1 <- redondeo(numerador_x1) 
cat("Cálculo del Numerador (redondeado) =", numerador_x1, "\n")
```

```{r}
x1 <- numerador_x1 / Ab[1, 1]
x1 <- redondeo(x1) 
cat("Cálculo de x1 (", numerador_x1, "/", Ab[1, 1], "): x1 =", x1, "\n")
```

```{r}
cat("\n--- Solución del sistema ---\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
```

 
#### Ejercicio 4.
  4x1+2x2 = 2
 2x1+3x2+x3 = −1
 x2+5/2x3 = 3
 
```{r}
A <- matrix(c(4, 2, 0,2, 3, 1,0, 1, 5/2), nrow = 3, byrow = TRUE)
```

```{r}
b <- matrix(c(2, -1, 3), nrow = 3)
```

```{r}
Ab <- cbind(A, b)
cat("Matriz aumentada inicial:\n")
print(Ab)
```

```{r}
m21 <- -Ab[2,1] / Ab[1,1]
Ab[2,] <- Ab[2,] + m21 * Ab[1,]
m31 <- -Ab[3,1] / Ab[1,1]
Ab[3,] <- Ab[3,] + m31 * Ab[1,]

cat("\nDespués de eliminar columna 1:\n")
print(Ab)
```

```{r}
m32 <- -Ab[3,2] / Ab[2,2]
Ab[3,] <- Ab[3,] + m32 * Ab[2,]

cat("\nDespués de eliminar columna 2 (Matriz triangular superior):\n")
print(Ab)
```

```{r}
x3 <- Ab[3,4] / Ab[3,3]
x2 <- (Ab[2,4] - Ab[2,3] * x3) / Ab[2,2]
x1 <- (Ab[1,4] - Ab[1,2] * x2 - Ab[1,3] * x3) / Ab[1,1]
```

```{r}
cat("\n--- Solución del sistema (Eliminación Gaussiana Simple) ---\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
cat("x3 =", x3, "\n")
```


#### Ejercicio 5.
 3x1−0.1x2−0.2x3 = 7.85
 0.1x1+7x2−0.3x3=−19.3
 0.3x1−0.2x2+10x3 = 71.4
 
```{r}
A <- matrix(c(3, -0.1, -0.2,0.1, 7, -0.3,0.3, -0.2, 10), nrow = 3, byrow = TRUE)
```

```{r}
b <- matrix(c(7.85, -19.3, 71.4), nrow = 3)
```

```{r}
Ab <- cbind(A, b)
cat("### Matriz Aumentada Inicial (Ab):\n")
print(Ab)
```

```{r}
m21 <- Ab[2,1] / Ab[1,1] 
m31 <- Ab[3,1] / Ab[1,1] 

Ab[2,] <- Ab[2,] - m21 * Ab[1,] 
Ab[3,] <- Ab[3,] - m31 * Ab[1,]

cat("\nDespués de eliminar columna 1 (Triangularidad parcial):\n")
print(Ab)
```

```{r}
m32 <- Ab[3,2] / Ab[2,2]

Ab[3,] <- Ab[3,] - m32 * Ab[2,]

cat("\nDespués de eliminar columna 2 (Matriz Triangular Superior):\n")
print(Ab)
```

```{r}
x3 <- Ab[3,4] / Ab[3,3]

x2 <- (Ab[2,4] - Ab[2,3] * x3) / Ab[2,2]

x1 <- (Ab[1,4] - Ab[1,2] * x2 - Ab[1,3] * x3) / Ab[1,1]
```

```{r}
cat("\n--- Solución del sistema ---\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
cat("x3 =", x3, "\n")
```

 
#### Ejercicio 9.
 1.133x1+5.281x2−2.454x3 = 6.414
 24.14x1−1.21x2+5.281x3 = 113.8
 −10.123x1+6.387x2−x3 = 1
 
```{r}
A <- matrix(c(1.133, 5.281, -2.454,24.14, -1.21, 5.281,-10.123, 6.387, -1), nrow = 3, byrow = TRUE)
```

```{r}
b <- matrix(c(6.414, 113.8, 1), nrow = 3)
```

```{r}
Ab <- cbind(A, b)
cat("### Matriz Aumentada Inicial:\n")
print(Ab)
```

```{r}
m21 <- -Ab[2,1] / Ab[1,1]
m31 <- -Ab[3,1] / Ab[1,1]


Ab[2,] <- Ab[2,] + m21 * Ab[1,]
Ab[3,] <- Ab[3,] + m31 * Ab[1,]

cat("### Matriz después de eliminar x1 (Columna 1):\n")
print(Ab)
```

```{r}
m32 <- -Ab[3,2] / Ab[2,2]

Ab[3,] <- Ab[3,] + m32 * Ab[2,]

cat("### Matriz Triangular Superior (después de eliminar x2):\n")
print(Ab)
```

```{r}
x3 <- Ab[3,4] / Ab[3,3]
x2 <- (Ab[2,4] - Ab[2,3] * x3) / Ab[2,2]

x1 <- (Ab[1,4] - Ab[1,2] * x2 - Ab[1,3] * x3) / Ab[1,1]
```

```{r}
cat("### Solución del Sistema de Ecuaciones Lineales\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
cat("x3 =", x3, "\n")
```


#### Ejercicio 10.
 A=( 2  3  2 4
     4 10 −4 0
    −3 −2 −5 −2
    −2  4  4 −7)
 
 b=(9
   −15
    6
    2)

```{r}
A <- matrix(c(2,3,2,4,4,10,-4,0,-3,-2,-5,-2,-2,4,4,-7), nrow = 4, byrow = TRUE)
```

```{r}
b <- matrix(c(9,-15,6,2), nrow = 4)
```

```{r}
Ab <- cbind(A, b)
cat("Matriz aumentada inicial:\n")
print(Ab)
```

```{r}
m21 <- -Ab[2,1] / Ab[1,1]
m31 <- -Ab[3,1] / Ab[1,1]
m41 <- -Ab[4,1] / Ab[1,1] 

Ab[2,] <- Ab[2,] + m21 * Ab[1,]
Ab[3,] <- Ab[3,] + m31 * Ab[1,]
Ab[4,] <- Ab[4,] + m41 * Ab[1,] 

cat("\nDespués de eliminar columna 1:\n")
print(Ab)
```

```{r}
m32 <- -Ab[3,2] / Ab[2,2]

Ab[3,] <- Ab[3,] + m32 * Ab[2,]

cat("\nDespués de eliminar columna 2:\n")
print(Ab)
```

```{r}
m43 <- -Ab[4,3] / Ab[3,3] 

Ab[4,] <- Ab[4,] + m43 * Ab[3,] 

cat("\nDespués de eliminar columna 3 (Matriz Triangular Superior):\n")
print(Ab)
```

```{r}
x4 <- Ab[4,5] / Ab[4,4]
```

```{r}
x3 <- (Ab[3,5] - Ab[3,4] * x4) / Ab[3,3] 
```

```{r}
x2 <- (Ab[2,5] - Ab[2,3] * x3 - Ab[2,4] * x4) / Ab[2,2]
```

```{r}
x1 <- (Ab[1,5] - Ab[1,2] * x2 - Ab[1,3] * x3 - Ab[1,4] * x4) / Ab[1,1]
```

```{r}
cat("\n--- Solución del sistema ---\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
cat("x3 =", x3, "\n")
cat("x4 =", x4, "\n")
```


![Ejercicio de Eliminacion Gaussiana Simple](G Simple.jpeg){width=550}
![Ejercicio de Eliminacion Gaussiana Simple](Gauss Simple.jpeg){width=550}


##### 


### Gauss con pivoteo parcial

#### Ejercicio 1. 
0.4x1−1.5x2+0.75x3 = −20
 −0.5x1−15x2+10x3 = −10
 −10x1−9x2+2.5x3 = 30

```{r}
valores <- c(0.4, -0.5, -10, -1.5, -15, -9,0.75, 10, 2.5)
A <- matrix(valores, nrow = 3)
(A)
```

```{r}
valoresb <- c(-20, -10, 30)
b <- matrix(valoresb, nrow = 3)
(b)
Ab <- cbind(A, b)
(Ab)
```

```{r}
r1 <- Ab[3,]
r2 <- Ab[2,]
r3 <- Ab[1,]
nM <- rbind(r1, r2, r3)
(nM)
```

```{r}
m1 <- -nM[2,1] / nM[1,1]; m1
m2 <- -nM[3,1] / nM[1,1]; m2
```

```{r}
A1 <- nM[1,]
A2 <- m1 * nM[1,] + nM[2,]
A3 <- m2 * nM[1,] + nM[3,]
NuevaA <- rbind(A1, A2, A3)
(NuevaA)
```

```{r}
m3 <- -NuevaA[3,2] / NuevaA[2,2]; m3
R1 <- NuevaA[1,]
R2 <- NuevaA[2,]
R3 <- m3 * NuevaA[2,] + NuevaA[3,]
Final <- rbind(R1, R2, R3)
(Final)
```

```{r}
x3 <- Final[3,4] / Final[3,3]
x2 <- (Final[2,4] - Final[2,3]*x3) / Final[2,2]
x1 <- (Final[1,4] - Final[1,2]*x2 - Final[1,3]*x3) / Final[1,1]
```

```{r}
cat("Soluciones:\n")
cat("x1 =", round(x1, 4), "\n")
cat("x2 =", round(x2, 4), "\n")
cat("x3 =", round(x3, 4), "\n")
```
 
 
#### Ejercicio 3 utilizar redondeo a 4 cifras significativas

0.003000x1+59.14x2 = 59.17
5.291x1−6.130x2 = 46.78
 
```{r}
A <- matrix(c(0.003000, 59.14, 5.291, -6.130), nrow = 2, byrow = TRUE)
(A)
```

```{r}
b <- matrix(c(59.17, 46.78), nrow = 2)
(b)
```

```{r}
Ab <- cbind(A, b)
(Ab)
```

```{r}
if (abs(Ab[2,1]) > abs(Ab[1,1])) {
  Ab <- Ab[c(2,1), ]
}
cat("Matriz después del pivoteo parcial:\n")
print(Ab)
```

```{r}
m21 <- signif(-Ab[2,1] / Ab[1,1])
Ab[2, ] <- signif(Ab[2, ] + m21 * Ab[1, ])
cat("\nMatriz después de la eliminación:\n")
print(Ab)
```

```{r}
x2 <- signif(Ab[2,3] / Ab[2,2])
x1 <- signif((Ab[1,3] - Ab[1,2]*x2) / Ab[1,1])
```

```{r}
cat("\nResultados:\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
```
 

#### Ejercicio 5.
 0.00031000x1+1.000000x2 = 3.000000
 1.00045534x1+1.00034333x2 = 7.000
 
```{r}
A <- matrix(c(0.00031000, 1.000000, 1.00045534, 1.00034333), nrow = 2, byrow = TRUE)
(A)
```

```{r}
b <- matrix(c(3.000000, 7.000000), nrow = 2)
(b)
```

```{r}
Ab <- cbind(A, b)
cat("Matriz aumentada inicial:\n")
print(Ab)
```

```{r}
if (abs(Ab[2,1]) > abs(Ab[1,1])) {
  temp <- Ab[1,]
  Ab[1,] <- Ab[2,]
  Ab[2,] <- temp
}
cat("Matriz después del pivoteo parcial:\n")
print(Ab)
```

```{r}
m <- -Ab[2,1] / Ab[1,1]
Ab[2,] <- Ab[2,] + m * Ab[1,]

cat("Matriz triangular superior:\n")
print(Ab)
```

```{r}
x2 <- Ab[2,3] / Ab[2,2]
x1 <- (Ab[1,3] - Ab[1,2]*x2) / Ab[1,1]
```

```{r}
cat("\nSolución del sistema:\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
```

#### Ejercicio 7.

A=(1/4 1/5 1/6 
   1/3 1/4 1/5
   1/2  1   2)
 
 b=(9
    8
    8)
 
 X=(x1
    x2
    x3)
    
```{r}     
A_valores <- c(
  signif(1/4, 4), signif(1/5, 4), signif(1/6, 4),
  signif(1/3, 4), signif(1/4, 4), signif(1/5, 4),
  signif(1/2, 4), signif(1, 4), signif(2, 4)
)
```

```{r}
A <- matrix(A_valores, nrow = 3, byrow = TRUE)
cat("Matriz A (4 cifras):\n")
print(A)
```

```{r}
b_valores <- c(9, 8, 8)
b <- matrix(b_valores, nrow = 3)
cat("\nVector b (4 cifras):\n")
print(b)
```

```{r}
Ab <- cbind(A, b)
cat("\nMatriz Aumentada Inicial:\n")
print(Ab)
```

```{r}
if (abs(Ab[2,1]) > abs(Ab[1,1]) || abs(Ab[3,1]) > abs(Ab[1,1])) {
  pivote_row <- 1
  if (abs(Ab[2,1]) > abs(Ab[pivote_row,1])) {
    pivote_row <- 2
  }
  if (abs(Ab[3,1]) > abs(Ab[pivote_row,1])) {
    pivote_row <- 3
  }
  if (pivote_row != 1) {
    Ab[c(1, pivote_row), ] <- Ab[c(pivote_row, 1), ]
  }
}
cat("\nMatriz después del Pivoteo Parcial (Columna 1):\n")
print(Ab)
```

```{r}
m21 <- signif(-Ab[2,1] / Ab[1,1], 4)
cat("\nMultiplicador m21 (4 cifras):", m21, "\n")
Ab[2, ] <- signif(Ab[2, ] + signif(m21 * Ab[1, ], 4), 4)
```

```{r}
m31 <- signif(-Ab[3,1] / Ab[1,1], 4)
cat("Multiplicador m31 (4 cifras):", m31, "\n")
Ab[3, ] <- signif(Ab[3, ] + signif(m31 * Ab[1, ], 4), 4)

cat("\nMatriz después de la Eliminación (Columna 1):\n")
print(Ab)
```

```{r}
if (abs(Ab[3,2]) > abs(Ab[2,2])) {
  Ab[c(2, 3), ] <- Ab[c(3, 2), ]
}
cat("\nMatriz después del Pivoteo Parcial (Columna 2):\n")
print(Ab)
```

```{r}
m32 <- signif(-Ab[3,2] / Ab[2,2], 4)
cat("\nMultiplicador m32 (4 cifras):", m32, "\n")
Ab[3, ] <- signif(Ab[3, ] + signif(m32 * Ab[2, ], 4), 4)

cat("\nMatriz después de la Eliminación Final:\n")
print(Ab)
```

```{r}
x3 <- signif(Ab[3,4] / Ab[3,3], 4)

x2_numerator <- signif(Ab[2,4] - signif(Ab[2,3] * x3, 4), 4)
x2 <- signif(x2_numerator / Ab[2,2], 4)

x1_term2 <- signif(Ab[1,2] * x2, 4)
x1_term3 <- signif(Ab[1,3] * x3, 4)
x1_numerator <- signif(Ab[1,4] - signif(x1_term2 + x1_term3, 4), 4)
x1 <- signif(x1_numerator / Ab[1,1], 4)
```

```{r}
cat("\n--- Soluciones (Redondeo a 4 Cifras Significativas) ---\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
cat("x3 =", x3, "\n")
```
 
#### Ejercicio 8.

A=( 1 1/2 1/3 1/4
  1/2 1/3 1/4 1/5
  1/3 1/4 1/5 1/6 
  1/4 1/5 1/6 1/7)

b=(1/6 
   1/7
   1/8
   1/9)
 
 X=(x1
    x2
    x3
    x4)
    
```{r}
A_frac <- matrix(c(
  1, 1/2, 1/3, 1/4,
  1/2, 1/3, 1/4, 1/5,
  1/3, 1/4, 1/5, 1/6,
  1/4, 1/5, 1/6, 1/7
), nrow = 4, byrow = TRUE)
```

```{r}
b_frac <- matrix(c(1/6, 1/7, 1/8, 1/9), nrow = 4)
```

```{r}
Ab <- signif(cbind(A_frac, b_frac), 4)

cat("Matriz Aumentada Inicial (redondeada a 4 cifras):\n")
print(Ab)
```

```{r}
n <- nrow(Ab)
for (k in 1:(n - 1)) {
  
  pivot_row <- k
  max_val <- abs(Ab[k, k])
  
  for (i in (k + 1):n) {
    if (abs(Ab[i, k]) > max_val) {
      max_val <- abs(Ab[i, k])
      pivot_row <- i
    }
  }
}
```
  
```{r}
  if (pivot_row != k) {
    Ab[c(k, pivot_row), ] <- Ab[c(pivot_row, k), ]
    cat(paste("\nIntercambio: Fila", k, "con Fila", pivot_row, "en la iteración", k, "\n"))
    print(Ab)
  }
```

```{r}
  for (i in (k + 1):n) {
    if (abs(Ab[i, k]) > max_val) {
      max_val <- abs(Ab[i, k])
      pivot_row <- i
    }
  }
```

```{r}
     if (pivot_row != k) {
    Ab[c(k, pivot_row), ] <- Ab[c(pivot_row, k), ]
    cat(paste("\nIntercambio: Fila", k, "con Fila", pivot_row, "en la iteración", k, "\n"))
    print(Ab)
  }
```

```{r}
X <- numeric(n)
X[n] <- signif(Ab[n, n + 1] / Ab[n, n], 4)
```

```{r}
for (i in (n - 1):1) {
  sum_val <- 0
  for (j in (i + 1):n) {
  
    sum_val <- sum_val + signif(Ab[i, j] * X[j], 4)
  }
  
  X[i] <- signif((Ab[i, n + 1] - sum_val) / Ab[i, i], 4)
}
```

```{r}
cat("\nResultados (redondeo a 4 cifras significativas):\n")
cat("x1 =", X[1], "\n")
cat("x2 =", X[2], "\n")
cat("x3 =", X[3], "\n")
cat("x4 =", X[4], "\n")
```

    
#### Ejercicio 9.
 2x1+x2−x3+x4−3x5 = 7
 x1+2x3−x4+x5 = 2
 −2x2−x3+x4−x5 = −5
 3x1+x2−4x3+5x5 = 6
 x1−x2−x3−x4+x5 = 3
 
```{r}
valores <- c(2,1,-1,1,-3,1,0,2,-1,1,0,-2,-1,1,-1,3,1,-4,0,5,1,-1,-1,-1,1)
A <- matrix(valores, nrow = 5, byrow = TRUE)
(A)
```

```{r}
valoresb <- c(7,2,-5,6,3)
b <- matrix(valoresb, nrow = 5)
(b)
```

```{r}
Ab <- cbind(A,b)
(Ab)
```

```{r}
r1 <- Ab[1,]
r2 <- Ab[2,]
r3 <- Ab[3,]
r4 <- Ab[4,]
r5 <- Ab[5,]
nM <- rbind(r1,r2,r3,r4,r5)
(nM)
```

```{r}
c1 <- nM[,1]
c2 <- nM[,2]
c3 <- nM[,3]
c4 <- nM[,4]
c5 <- nM[,5]
a11 <- nM[1,1]
a22 <- nM[2,2]
a32 <- nM[3,2]
a23 <- nM[2,3]
a14 <- nM[1,4]
a24 <- nM[2,4]
```

```{r}
m1 <- -nM[2,1]/nM[1,1]
m2 <- -nM[3,1]/nM[1,1]
m3 <- -nM[4,1]/nM[1,1]
m4 <- -nM[5,1]/nM[1,1]

A1 <- nM[1,]
A2 <- m1*nM[1,] + nM[2,]
A3 <- m2*nM[1,] + nM[3,]
A4 <- m3*nM[1,] + nM[4,]
A5 <- m4*nM[1,] + nM[5,]

NuevaA <- rbind(A1,A2,A3,A4,A5)
(NuevaA)
```

```{r}
m5 <- -NuevaA[3,2]/NuevaA[2,2]
m6 <- -NuevaA[4,2]/NuevaA[2,2]
m7 <- -NuevaA[5,2]/NuevaA[2,2]

R1 <- NuevaA[1,]
R2 <- NuevaA[2,]
R3 <- m5*NuevaA[2,] + NuevaA[3,]
R4 <- m6*NuevaA[2,] + NuevaA[4,]
R5 <- m7*NuevaA[2,] + NuevaA[5,]

Nueva <- rbind(R1,R2,R3,R4,R5)
(Nueva)
```

```{r}
m8 <- -Nueva[4,3]/Nueva[3,3]
m9 <- -Nueva[5,3]/Nueva[3,3]

R1 <- Nueva[1,]
R2 <- Nueva[2,]
R3 <- Nueva[3,]
R4 <- m8*Nueva[3,] + Nueva[4,]
R5 <- m9*Nueva[3,] + Nueva[5,]

Nueva2 <- rbind(R1,R2,R3,R4,R5)
(Nueva2)
```

```{r}
m10 <- -Nueva2[5,4]/Nueva2[4,4]

R1 <- Nueva2[1,]
R2 <- Nueva2[2,]
R3 <- Nueva2[3,]
R4 <- Nueva2[4,]
R5 <- m10*Nueva2[4,] + Nueva2[5,]

Final <- rbind(R1,R2,R3,R4,R5)
(Final)
```

```{r}
R1 <- Final[1,]
R2 <- Final[2,]
R3 <- Final[3,]
R4 <- Final[4,]
R5 <- Final[5,]

v <- R5[5] / R5[4]  
z <- (R4[5] - R4[4]*v) / R4[3]  
y <- (R3[5] - R3[3]*z - R3[4]*v) / R3[2]  
x <- (R2[5] - R2[3]*z - R2[4]*v - R2[2]*y) / R2[1]  
u <- (R1[5] - R1[2]*y - R1[3]*z - R1[4]*v - R1[1]*x) / R1[1]
```

```{r}
x1 <- u
x2 <- y
x3 <- z
x4 <- v
x5 <- R5[5]/R5[5]

x1; x2; x3; x4; x5
```
 
#### Ejercicio 10.
 3.333x1+15920x2−10.333x3 = 15913
 2.222x1+16.71x29.612x2 = 28.544
 1.5611x1+5.1791x2+1.6852x3 = 8.4254

```{r}
valores <- c(3.333, 15920, -10.333,2.222, 16.71, 9.612,1.5611, 5.1791, 1.6852)
A <- matrix(valores, nrow = 3, byrow = TRUE)
(A)
```

```{r}
valoresb <- c(15913, 28.544, 8.4254)
b <- matrix(valoresb, nrow = 3)
(b)
```

```{r}
Ab <- cbind(A, b)
Ab
```

```{r}
m1 <- -Ab[2,1] / Ab[1,1]; m1
m2 <- -Ab[3,1] / Ab[1,1]; m2

A1 <- Ab[1,]
A2 <- m1 * Ab[1,] + Ab[2,]
A3 <- m2 * Ab[1,] + Ab[3,]
NuevaA <- rbind(A1, A2, A3)
(NuevaA)
```

```{r}
m3 <- -NuevaA[3,2] / NuevaA[2,2]; m3

R1 <- NuevaA[1,]
R2 <- NuevaA[2,]
R3 <- m3 * NuevaA[2,] + NuevaA[3,]
Final <- rbind(R1, R2, R3)
(Final)
```

```{r}
x3 <- Final[3,4] / Final[3,3]
(x3)

x2 <- (Final[2,4] - Final[2,3]*x3) / Final[2,2]
(x2)

x1 <- (Final[1,4] - Final[1,2]*x2 - Final[1,3]*x3) / Final[1,1]
(x1)
```

```{r}
cat("Soluciones:\n")
cat("x1 =", x1, "\n")
cat("x2 =", x2, "\n")
cat("x3 =", x3, "\n") 
```



![Ejercicio de Eliminacion Gaussiana Con Pivoteo parcial](P Parcial.jpeg){width=550}
![Ejercicio de Eliminacion Gaussiana Con Pivoteo parcial](Pivoteo P.jpeg){width=550}


##### 


### Gauss Jordan 

#### Ejercicio 1.
 x1+2x2+3x3 = 1
 −0.4x1+2x2−x3 = 10
 0.5x1−3x2+x3 = 15
 
```{r}
valores <- c(0,2,3,-0.4,2,-0,0.5,-3,0)
A <- matrix(valores, nrow = 3, byrow = TRUE)
(A)
```

```{r}
valoresb <- c(1,10,15)
b <- matrix(valoresb, nrow = 3)
(b)
```

```{r}
M <- matrix(c(
    1,   2,   3,    1,
    -0.4, 2,  -1,   10,
    0.5, -3,  1,    15
), nrow=3, byrow=TRUE)

print("--- Matriz Aumentada Inicial ---")
print(M)
```

```{r}
n <- nrow(M)
m <- n

for (j in 1:m) {
    pivote_val <- abs(M[j, j])
    pivote_row <- j
    
  if (j<n){ 
      for(i in (j+1):n){
        if (abs(M[i,j]) >
    pivote_val){
          pivote_val <-
            abs(M[i,j])
          pivote_row <- i
        }
        
      }
        
  }
}
        
```

```{r}
    if (pivote_row != j) {
        M[c(j, pivote_row),] <- M[c(pivote_row, j),]
        print(paste("--- Paso:", j, "Intercambio de Filas (R", j, " <-> R", pivote_row, ") ---"))
        print(M)
    }
```

```{r}
    if (M[j, j] == 0) {
        warning("El elemento pivote es cero. El sistema no tiene solución única o tiene infinitas soluciones.")
        next
    }
```

```{r}
    divisor <- M[j, j]
    M[j,] <- M[j,] / divisor

    print(paste("--- Paso:", j, "Normalización (R", j, " <- R", j, " /", round(divisor, 4), ") ---"))
    print(M)
```

```{r}
    for (i in 1:n) {
        if (i != j) {
            factor <- M[i, j]
            M[i,] <- M[i,] - factor * M[j,]

            print(paste("--- Paso:", j, "Eliminación (R", i, " <- R", i, " -", round(factor, 4), " * R", j, ") ---"))
            print(M)
        }
    }
```

```{r}
print("--- Matriz Final en Forma Escalonada Reducida por Filas ---")
print(M)

x1 <- M[1, m + 1]
x2 <- M[2, m + 1]
x3 <- M[3, m + 1]
```

```{r}
print("--- Solución Final (x1, x2, x3) ---")
print(paste("x1 =", round(x1, 4)))
print(paste("x2 =", round(x2, 4)))
print(paste("x3 =", round(x3, 4)))
```
 

#### Ejercicio 2.
 2x1−0.9x2+3x3 = −3.61
 −0.5x1+0.1x2−x3 = 2.035
 x1−6.35x2−0.45x3 = 15.401
 
```{r}
valores <- c(2,-0.9,3,-0.5,0.1,-0,0,-6.35,-0.45 )
A <- matrix(valores, nrow = 3, byrow = TRUE)
(A)
```

```{r}
b <- c(-3.61, 2.035, 15.401)
```

```{r}
M <- cbind(A, b)
print("--- Paso 1: Matriz Aumentada Inicial ---")
print(M)
cat("\n")
```

```{r}
cat("--- Paso 2.1: Convertir M[1,1] en 1 (Pivote de la Fila 1) --- \n")
pivote_1 <- M[1, 1]
M[1, ] <- M[1, ] / pivote_1
print(M)
cat("\n")
```

```{r}
cat("--- Paso 2.2: Convertir M[2,1] en 0 --- \n")
factor_21 <- M[2, 1]
M[2, ] <- M[2, ] - factor_21 * M[1, ]
print(M)
cat("\n")
```

```{r}
cat("--- Paso 2.3: Convertir M[3,1] en 0 --- \n")
factor_31 <- M[3, 1]
M[3, ] <- M[3, ] - factor_31 * M[1, ]
print(M)
cat("\n")
```

```{r}
cat("--- Paso 2.4: Convertir M[2,2] en 1 (Pivote de la Fila 2) --- \n")
pivote_2 <- M[2, 2]
M[2, ] <- M[2, ] / pivote_2
print(M)
cat("\n")
```

```{r}
cat("--- Paso 2.5: Convertir M[3,2] en 0 --- \n")
factor_32 <- M[3, 2]
M[3, ] <- M[3, ] - factor_32 * M[2, ]
print(M)
cat("\n")
```

```{r}
cat("--- Paso 2.6: Convertir M[3,3] en 1 (Pivote de la Fila 3) --- \n")
pivote_3 <- M[3, 3]
M[3, ] <- M[3, ] / pivote_3
print(M)
cat("\n")
```

```{r}

cat("--- Paso 3.1: Convertir M[2,3] en 0 --- \n")
factor_23 <- M[2, 3]
M[2, ] <- M[2, ] - factor_23 * M[3, ]
print(M)
cat("\n")
```

```{r}
cat("--- Paso 3.2: Convertir M[1,3] en 0 --- \n")
factor_13 <- M[1, 3]
M[1, ] <- M[1, ] - factor_13 * M[3, ]
print(M)
cat("\n")
```

```{r}
cat("--- Paso 3.3: Convertir M[1,2] en 0 --- \n")
factor_12 <- M[1, 2]
M[1, ] <- M[1, ] - factor_12 * M[2, ]
print(M)
cat("\n")
```

```{r}
print("--- Paso 4: Matriz en la Forma Reducida por Filas (Identidad) ---")
print(M)

soluciones <- M[, 4]
nombres <- c("x1", "x2", "x3")
resultado <- data.frame(Variable = nombres, Valor = soluciones)
print("--- Solución Final del Sistema ---")
print(resultado)
```

#### Ejercicio 3.
 0.7x1+2.7x2−6x3+0.7x4 = 1.6487
 2x1−0.8x2+3x3−x4 = −2.342
 −x1−1.5x2+1.4x3+3x4 = −4.189
 7x2−1.56x3+x4=15.792

```{r}
valores <- c(0.7,2.7,-6,0.7,2,-0.8,3,-0,-0,-1.5,1.4,3,0,7,-1.56,0)
A <- matrix(valores, nrow = 4, byrow = TRUE)
(A)
```

```{r}
b <- c(1.6487,-2.342,-4.189,15.792)
```

```{r}
M <- cbind(A, b)
print("--- Paso 1: Matriz Aumentada Inicial ---")
print(M)
cat("\n")
```

```{r}
A_aumentada <- matrix(c(0.7, 2.7, -6, 0.7, 1.6487,2, -0.8, 3, -1, -2.342,-1, -1.5, 1.4, 3, -4.189,0, 7, -1.56, 1, 15.792),nrow = 4,byrow = TRUE)
cat("--- Matriz Aumentada Inicial ---\n")
print(A_aumentada)
```

```{r}
# R1 = R1 / 0.7
A_aumentada[1, ] <- A_aumentada[1, ] / A_aumentada[1, 1]
cat("\n--- Después de R1 = R1 / (0.7) ---\n")
print(A_aumentada)
```

```{r}
# R2 = R2 - 2 * R1
A_aumentada[2, ] <- A_aumentada[2, ] - 2 * A_aumentada[1, ]
# R3 = R3 - (-1) * R1  => R3 = R3 + R1
A_aumentada[3, ] <- A_aumentada[3, ] + A_aumentada[1, ]
# R4 ya tiene un cero
cat("\n--- Después de hacer ceros debajo del pivote (1,1) ---\n")
print(A_aumentada)
```

```{r}
# El valor es A_aumentada[2, 2]
pivote_2_2 <- A_aumentada[2, 2]
A_aumentada[2, ] <- A_aumentada[2, ] / pivote_2_2
cat("\n--- Después de hacer el pivote (2,2) = 1 ---\n")
print(A_aumentada)
```

```{r}
# R1 = R1 - A_aumentada[1, 2] * R2
A_aumentada[1, ] <- A_aumentada[1, ] - A_aumentada[1, 2] * A_aumentada[2, ]
# R3 = R3 - A_aumentada[3, 2] * R2
A_aumentada[3, ] <- A_aumentada[3, ] - A_aumentada[3, 2] * A_aumentada[2, ]
# R4 = R4 - A_aumentada[4, 2] * R2
A_aumentada[4, ] <- A_aumentada[4, ] - A_aumentada[4, 2] * A_aumentada[2, ]
cat("\n--- Después de hacer ceros con el pivote (2,2) ---\n")
print(A_aumentada)
```

```{r}
# El valor es A_aumentada[3, 3]
pivote_3_3 <- A_aumentada[3, 3]
A_aumentada[3, ] <- A_aumentada[3, ] / pivote_3_3
cat("\n--- Después de hacer el pivote (3,3) = 1 ---\n")
print(A_aumentada)
```

```{r}
# R1 = R1 - A_aumentada[1, 3] * R3
A_aumentada[1, ] <- A_aumentada[1, ] - A_aumentada[1, 3] * A_aumentada[3, ]
# R2 = R2 - A_aumentada[2, 3] * R3
A_aumentada[2, ] <- A_aumentada[2, ] - A_aumentada[2, 3] * A_aumentada[3, ]
# R4 = R4 - A_aumentada[4, 3] * R3
A_aumentada[4, ] <- A_aumentada[4, ] - A_aumentada[4, 3] * A_aumentada[3, ]
cat("\n--- Después de hacer ceros con el pivote (3,3) ---\n")
print(A_aumentada)
```

```{r}
# El valor es A_aumentada[4, 4]
pivote_4_4 <- A_aumentada[4, 4]
A_aumentada[4, ] <- A_aumentada[4, ] / pivote_4_4
cat("\n--- Después de hacer el pivote (4,4) = 1 ---\n")
print(A_aumentada)
```

```{r}
# R1 = R1 - A_aumentada[1, 4] * R4
A_aumentada[1, ] <- A_aumentada[1, ] - A_aumentada[1, 4] * A_aumentada[4, ]
# R2 = R2 - A_aumentada[2, 4] * R4
A_aumentada[2, ] <- A_aumentada[2, ] - A_aumentada[2, 4] * A_aumentada[4, ]
# R3 = R3 - A_aumentada[3, 4] * R4
A_aumentada[3, ] <- A_aumentada[3, ] - A_aumentada[3, 4] * A_aumentada[4, ]
cat("\n Después de hacer ceros con el pivote (4,4) \n")
cat(" Forma Escalonada Reducida (Matriz Identidad) \n")
print(A_aumentada)
```

```{r}
solucion <- A_aumentada[, 5]
cat(sprintf("x1 = %f\n", solucion[1]))
cat(sprintf("x2 = %f\n", solucion[2]))
cat(sprintf("x3 = %f\n", solucion[3]))
cat(sprintf("x4 = %f\n", solucion[4]))
```

```{r}
# Se redondea
cat("\n*** Solución Redondeada a 4 decimales: ***\n")
cat(sprintf("x1 = %.4f\n", round(solucion[1], 4)))
cat(sprintf("x2 = %.4f\n", round(solucion[2], 4)))
cat(sprintf("x3 = %.4f\n", round(solucion[3], 4)))
cat(sprintf("x4 = %.4f\n", round(solucion[4], 4)))
```
 
#### Ejercicio 4.
 3x1−0.1x2−0.2x3 = 7.85
 0.1x1+7x2−0.3x3 = −19.3
 0.3x1−0.2x2+10x3 = 71.4
 
```{r}
valores <- c(3,-0.1,-0.2,0.1,7,-0.3,0.3,-0.2,10)
A <- matrix(valores, nrow = 3, byrow = TRUE)
(A)
```

```{r}
b <- c(7.85,-19.3,71.4)
```

```{r}
A <- matrix(c(3, -0.1, -0.2, 7.85,0.1, 7, -0.3, -19.3,0.3, -0.2, 10, 71.4), nrow = 3, byrow = TRUE)
print("--- Matriz Aumentada Inicial ---")
print(A)
```

```{r}
n <- nrow(A)
m <- ncol(A)
```

```{r}
for (i in 1:n) {
  
  pivot <- A[i, i]
  
  if (abs(pivot) < 1e-9) {
    stop(paste("El pivote en la fila", i, "es cero. El sistema podría no tener solución única."))
  }
}
  
  A[i, ] <- A[i, ] / pivot
  
  cat("\n Paso", i, ": Normalizar el pivote A[", i, ",", i, "] a 1 \n")
  print(A)
```

```{r}
  for (j in 1:n) {
    if (i != j) { 
      
      
      factor <- A[j, i]
      
      
      A[j, ] <- A[j, ] - factor * A[i, ]
    }
  }
  
  cat("\n--- Paso", i, ": Eliminar el resto de elementos en la columna", i, "---\n")
  print(A)
```

```{r}
print(" 4. Matriz en Forma Escalonada Reducida (Gauss-Jordan) ")
print(A)
```

```{r}
solucion <- A[, m]

print("\n 5. Solución del Sistema ")
cat("x1 =", solucion[1], "\n")
cat("x2 =", solucion[2], "\n")
cat("x3 =", solucion[3], "\n")
```
 
#### Ejercicio  6.
A= (1 3 −2 1
        1 3 −1 2
        0 1 −1 4
        2 6 1 2)
 
 b=(4
    1
    5
    2)
    
```{r}
A <- matrix(c(1, 1, 0, 2,3, 3, 1, 6,-2, -1, -1, 1,1, 2, 4, 2), nrow = 4, byrow = FALSE)
```

```{r}
b <- c(4, 1, 5, 2)
```

```{r}
print("Matriz A:")
print(A)
```

```{r}
M <- cbind(A, b)
n <- nrow(M)
m <- ncol(M) 

cat("\n### Matriz Aumentada Inicial [A | b] ###\n")
print(M)
```

```{r}
gauss_jordan_paso_a_paso <- function(M) {
    n <- nrow(M)
    for (k in 1:n) {
        pivote_val <- M[k, k]
        
        if (abs(pivot_val) < 1e-10) { 
          
            if (all(M[k:n, k] == 0)) {
                cat(sprintf("\n Advertencia: Columna %d con ceros. El sistema podría no tener solución única.\n", k))
                next 
            }
            stop(sprintf("Error: Pivote en M[%d,%d] es cero o muy cercano a cero. Se requiere intercambio de filas.", k, k))
        }
    }
}
```

```{r}
        for (i in (k + 1):n) {
            if (i > n) break 
            
            factor <- M[i, k]

            M[i, ] <- M[i, ] - factor * M[k, ]
            
            cat(sprintf("\n### Paso %d.%d: Eliminación Debajo (Fila %d) ###\n", k * 2, i - k, i))
            cat(sprintf("Operación: F%d = F%d - (%.4f) * F%d\n", i, i, factor, k))
            print(M)
        }
```

```{r}
    step_count <- 0
    for (k in n:2) {
        for (i in 1:(k - 1)) {
            factor <- M[i, k]
      if (abs(factor) > 1e-10) { 
              
      M[i, ] <- M[i, ] - factor * M[k, ]
         step_count <- step_count + 1
                
                cat(sprintf("\n### Paso Atrás %d: Eliminación Arriba (Fila %d) ###\n", step_count, i))
                cat(sprintf("Operación: F%d = F%d - (%.4f) * F%d\n", i, i, factor, k))
                print(M)
            }
        }
    }
```

```{r}
        if (step_count > 0) { 
            cat("\n--- Fin del Bloque de Eliminación hacia Atrás para la Columna ", k, " ---\n")
        }
```
    
```{r}

    solucion <- M[, m]
    names(solucion) <- paste0("x", 1:n)
    
    cat("\n### Solución Final ###\n")
    cat("Dado que la matriz reducida final es:\n")
    print(M)
```

```{r}
    cat("\nEsto corresponde al sistema:\n")
    cat(sprintf("x1 = %.4f\n", solucion[1]))
    cat(sprintf("x2 = %.4f\n", solucion[2]))
    cat(sprintf("x3 = %.4f\n", solucion[3]))
    cat(sprintf("x4 = %.4f\n", solucion[4]))
    
```

 
#### Ejercicio  7.
 6x1−x2−x3+4x4 = 17
 x1−10x2+2x3−x4 = −17
 3x1−2x2+8x3−x4 = 19
 x1+x2+x3−5x4 = −14

```{r} 
M <- matrix(c(6, -1, -1,  4,  17,1, -10,  2, -1, -17,3, -2,  8, -1,  19,1,  1,  1, -5, -14), nrow = 4, byrow = TRUE)
```

```{r}
print("--- Matriz Aumentada Inicial ---")
print(M)
cat("\n")
```

```{r}
m <- nrow(M)
n <- ncol(M)
```

```{r}
print("--- Paso 1: Intercambio F1 <-> F2 ---")
M[c(1, 2), ] <- M[c(2, 1), ]
print(M)
cat("\n")
```

```{r}
print("--- Paso 2: Eliminar debajo de M[1, 1] ---")
M[2, ] <- M[2, ] - 6 * M[1, ]
print("F2 <- F2 - 6*F1")
print(M)
cat("\n")
```

```{r}
M[3, ] <- M[3, ] - 3 * M[1, ]
print("F3 <- F3 - 3*F1")
print(M)
cat("\n")
```

```{r}
M[4, ] <- M[4, ] - 1 * M[1, ]
print("F4 <- F4 - 1*F1")
print(M)
cat("\n")
```

```{r}
print("--- Paso 3: Crear 1 líder en M[2, 2] ---")
M[2, ] <- M[2, ] / M[2, 2]
print("F2 <- F2 / M[2, 2]")
print(M)
cat("\n")
```

```{r}
print("--- Paso 4: Eliminar debajo de M[2, 2] ---")

M[3, ] <- M[3, ] - 28 * M[2, ]
print("F3 <- F3 - 28*F2")
print(M)
cat("\n")
```

```{r}
M[4, ] <- M[4, ] - 11 * M[2, ]
print("F4 <- F4 - 11*F2")
print(M)
cat("\n")
```


```{r}
print("--- Paso 5: Crear 1 líder en M[3, 3] ---")
M[3, ] <- M[3, ] / M[3, 3]
print("F3 <- F3 / M[3, 3]")
print(M)
cat("\n")
```

```{r}

print("--- Paso 6: Eliminar debajo de M[3, 3] ---")
M[4, ] <- M[4, ] - M[4, 3] * M[3, ]
print("F4 <- F4 - M[4, 3] * F3")
print(M)
cat("\n")
```

```{r}
print("--- Paso 7: Crear 1 líder en M[4, 4] ---")
M[4, ] <- M[4, ] / M[4, 4]
print("F4 <- F4 / M[4, 4]")
print(M)
cat("\n")
```

```{r}
print("--- Paso 8: Eliminar encima de M[4, 4] (Columna 4) ---")
M[3, ] <- M[3, ] - M[3, 4] * M[4, ]
print("F3 <- F3 - M[3, 4] * F4")
print(M)
cat("\n")
```

```{r}
M[2, ] <- M[2, ] - M[2, 4] * M[4, ]
print("F2 <- F2 - M[2, 4] * F4")
print(M)
cat("\n")
```

```{r}
M[1, ] <- M[1, ] - M[1, 4] * M[4, ]
print("F1 <- F1 - M[1, 4] * F4")
print(M)
cat("\n")
```

```{r}
print("--- Paso 9: Eliminar encima de M[3, 3] (Columna 3) ---")

M[2, ] <- M[2, ] - M[2, 3] * M[3, ]
print("F2 <- F2 - M[2, 3] * F3")
print(M)
cat("\n")
```

```{r}
M[1, ] <- M[1, ] - M[1, 3] * M[3, ]
print("F1 <- F1 - M[1, 3] * F3")
print(M)
cat("\n")
```

```{r}
print("--- Paso 10: Eliminar encima de M[2, 2] (Columna 2) ---")

M[1, ] <- M[1, ] - M[1, 2] * M[2, ]
print("F1 <- F1 - M[1, 2] * F2")
print(M)
cat("\n")
```

```{r}
solucion <- M[, n]
names(solucion) <- c("x1", "x2", "x3", "x4")

print("Solución:")
print(solucion)
```
 
#### Ejercicio  10.
 15x1−18x2+15x3−3x4 = 11
 −18x1+242−18x3+4x4 = 10
 15x1−18x2+18x3−3x4 = 11
 −3x1+4x2−3x3+x4 = 13
 
```{r} 
M <- matrix(c(15, -18,  15, -3,11,-18,  24, -18,4,10,15, -18,  18, -3,  11,
  -3,   4,  -3,  1,  13
), nrow = 4, byrow = TRUE)
```

```{r}
cat("### Matriz Aumentada Inicial ###\n")
print(M)
```

```{r}
M[1, ] <- M[1, ] / M[1, 1]

cat("### Paso 2a: Fila 1 / M[1,1] (Pivot 1 = 1) ###\n")
print(M)
```

```{r}
M[2, ] <- M[2, ] - M[2, 1] * M[1, ]
M[3, ] <- M[3, ] - M[3, 1] * M[1, ]
M[4, ] <- M[4, ] - M[4, 1] * M[1, ]

cat("### Hacer 0's debajo del Pivote 1 (Columna 1) ###\n")
print(M)
```

```{r}
M[2, ] <- M[2, ] / M[2, 2]

cat("### Fila 2 / M[2,2] (Pivot 2 = 1) ###\n")
print(M)
```

```{r}
M[3, ] <- M[3, ] - M[3, 2] * M[2, ]
M[4, ] <- M[4, ] - M[4, 2] * M[2, ]

cat("### Hacer 0's debajo de la columna 2 ###\n")
print(M)
```

```{r}
M[3, ] <- M[3, ] / M[3, 3]

cat("### Paso 2e: Fila 3 / M[3,3] (Pivot 3 = 1) ###\n")
print(M)
```

```{r}
M[4, ] <- M[4, ] - M[4, 3] * M[3, ]

cat("### Hacer 0's debajo de la Columna 3 ###\n")
print(M)
```

```{r}
M[4, ] <- M[4, ] / M[4, 4]

cat("### Fila 4 / M[4,4] (Pivot 4 = 1) ###\n")
print(M)
```

```{r}
cat("\n### Matriz en Forma Escalonada ###\n")
print(M)
```

```{r}
M[3, ] <- M[3, ] - M[3, 4] * M[4, ]
M[2, ] <- M[2, ] - M[2, 4] * M[4, ]
M[1, ] <- M[1, ] - M[1, 4] * M[4, ]

cat("### Paso 3a: Hacer 0's arriba del Pivote 4 (Columna 4) ###\n")
print(M)
```

```{r}
M[2, ] <- M[2, ] - M[2, 3] * M[3, ]
M[1, ] <- M[1, ] - M[1, 3] * M[3, ]

cat("### Paso 3b: Hacer 0's arriba de la Columna 3 ###\n")
print(M)
```

```{r}
M[1, ] <- M[1, ] - M[1, 2] * M[2, ]

cat("### Hacer 0's arriba de la Columna 2 ###\n")
print(M)
```

```{r}
cat("### Matriz Final en Forma Escalonada Reducida ###\n")
print(M)
```

```{r}
solucion <- M[, 5]

cat("### Solución del Sistema (x1, x2, x3, x4) ###\n")
cat("x1 =", solucion[1], "\n")
cat("x2 =", solucion[2], "\n")
cat("x3 =", solucion[3], "\n")
cat("x4 =", solucion[4], "\n")
```


![Ejercicio de metodode Gauss-Jordan](Gauss Jordan.jpeg){width=550}
![Ejercicio de metodode Gauss-Jordan](Gauss J.jpeg){width=550}


## Metodos Interativos


### Gauss-seidel

#### Ejercicio  1.
 3x1−0.2x2−0.5x3 = 8
 0.1x1+7x2+0.4x3 = −19.5
 0.4x1−0.1x2+10x3 = 72.4


```{r}
A <- matrix(c(3,-0.2,-0.5,0.1,  7,0.4,0.4, -0.1, 10), nrow = 3, byrow = TRUE)
b <- c(8, -19.5, 72.4)
```

```{r}
x <- rep(0, 3)   # x^(0) = (0,0,0)
tol <- 1e-8
maxiter <- 100

cat("x^(0) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 1 ---
x_old <- x
# fila 1
s1 <- 0
s2 <- sum(A[1,2:3] * x_old[2:3])   # -0.2*x2_old + -0.5*x3_old
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 1 - x1 =", sprintf("%.10f", x[1]), "\n")
# fila 2
s1 <- A[2,1] * x[1]                 # 0.1*x1_new
s2 <- A[2,3] * x_old[3]            # 0.4*x3_old
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 1 - x2 =", sprintf("%.10f", x[2]), "\n")
# fila 3
s1 <- A[3,1] * x[1] + A[3,2] * x[2] # 0.4*x1_new + -0.1*x2_new
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 1 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(1) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 2  ---
x_old <- x
# fila 1
s1 <- 0
s2 <- sum(A[1,2:3] * x_old[2:3])
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 2 - x1 =", sprintf("%.10f", x[1]), "\n")
# fila 2
s1 <- A[2,1] * x[1]
s2 <- A[2,3] * x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 2 - x2 =", sprintf("%.10f", x[2]), "\n")
# fila 3
s1 <- A[3,1] * x[1] + A[3,2] * x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 2 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(2) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 3 ---
x_old <- x
s1 <- 0
s2 <- sum(A[1,2:3] * x_old[2:3])
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 3 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1] * x[1]
s2 <- A[2,3] * x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 3 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1] * x[1] + A[3,2] * x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 3 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(3) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 4 ---
x_old <- x
s1 <- 0
s2 <- sum(A[1,2:3] * x_old[2:3])
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 4 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1] * x[1]
s2 <- A[2,3] * x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 4 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1] * x[1] + A[3,2] * x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 4 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(4) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 5 ---
x_old <- x
s1 <- 0
s2 <- sum(A[1,2:3] * x_old[2:3])
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 5 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1] * x[1]
s2 <- A[2,3] * x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 5 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1] * x[1] + A[3,2] * x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 5 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(5) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
converged_iter <- NA
for (k in 6:maxiter) {
  x_old <- x
  for (i in 1:3) {
    s1 <- if (i>1) sum(A[i, 1:(i-1)] * x[1:(i-1)]) else 0
    s2 <- if (i<3) sum(A[i, (i+1):3] * x_old[(i+1):3]) else 0
    x[i] <- (b[i] - s1 - s2) / A[i,i]
  }
  dx_inf <- max(abs(x - x_old))
  r_inf <- max(abs(b - A %*% x))
  cat(sprintf("x^(%d) = [%s]  ||dx||_inf = %.3e  ||r||_inf = %.3e\n",
              k, paste(sprintf("%.10f", x), collapse = ", "), dx_inf, r_inf))
  if (dx_inf < tol) {
    converged_iter <- k
    cat(sprintf("\nConvergencia alcanzada en iteración %d con ||dx||_inf = %.3e < %.0e\n",
                k, dx_inf, tol))
    break
  }
}

if (is.na(converged_iter)) {
  cat("\nNo se alcanzó la tolerancia en el máximo de iteraciones.\n")
}
```

```{r}
x_exacta <- solve(A, b)
cat("\nSolución exacta (solve):", paste(sprintf("%.10f", x_exacta), collapse = ", "), "\n")
if (!is.na(converged_iter)) {
  diff <- abs(x - x_exacta)
  cat("Diferencia absoluta respecto a la solución exacta:", paste(sprintf("%.3e", diff), collapse = ", "), "\n")
}
```

#### Ejercicio 2.
 −5x1+1.4x2−2.7x3 = 94.2
 0.7x1−2.5x2+15x3 = −6
 3.3x1−11x2+4.4x3 = −27.5

```{r}

A <- matrix(c(-5.0,1.4,-2.7,0.7,-2.5,15.0,3.3,-11.0,4.4), nrow = 3, byrow = TRUE)
b <- c(94.2, -6.0, -27.5)
```

```{r}
x <- rep(0, 3)    
tol <- 1e-8
maxiter <- 200
div_threshold <- 1e6  

cat("x^(0) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```
```{r}
# --- Iteración 1  ---
x_old <- x
s1 <- 0
s2 <- A[1,2]*x_old[2] + A[1,3]*x_old[3]
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 1 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1]*x[1]
s2 <- A[2,3]*x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 1 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1]*x[1] + A[3,2]*x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 1 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(1) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```
```{r}
# --- Iteración 2  ---
x_old <- x
s1 <- 0
s2 <- A[1,2]*x_old[2] + A[1,3]*x_old[3]
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 2 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1]*x[1]
s2 <- A[2,3]*x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 2 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1]*x[1] + A[3,2]*x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 2 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(2) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 3 ---
x_old <- x
s1 <- 0
s2 <- A[1,2]*x_old[2] + A[1,3]*x_old[3]
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 3 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1]*x[1]
s2 <- A[2,3]*x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 3 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1]*x[1] + A[3,2]*x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 3 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(3) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 4  ---
x_old <- x
s1 <- 0
s2 <- A[1,2]*x_old[2] + A[1,3]*x_old[3]
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 4 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1]*x[1]
s2 <- A[2,3]*x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 4 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1]*x[1] + A[3,2]*x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 4 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(4) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
# --- Iteración 5 ---
x_old <- x
s1 <- 0
s2 <- A[1,2]*x_old[2] + A[1,3]*x_old[3]
x[1] <- (b[1] - s1 - s2) / A[1,1]
cat("Iteración 5 - x1 =", sprintf("%.10f", x[1]), "\n")
s1 <- A[2,1]*x[1]
s2 <- A[2,3]*x_old[3]
x[2] <- (b[2] - s1 - s2) / A[2,2]
cat("Iteración 5 - x2 =", sprintf("%.10f", x[2]), "\n")
s1 <- A[3,1]*x[1] + A[3,2]*x[2]
s2 <- 0
x[3] <- (b[3] - s1 - s2) / A[3,3]
cat("Iteración 5 - x3 =", sprintf("%.10f", x[3]), "\n")
cat("x^(5) =", paste(sprintf("%.10f", x), collapse = ", "), "\n\n")
```

```{r}
converged_iter <- NA
for (k in 6:maxiter) {
  x_old <- x
  for (i in 1:3) {
    s1 <- if (i > 1) sum(A[i, 1:(i-1)] * x[1:(i-1)]) else 0
    s2 <- if (i < 3) sum(A[i, (i+1):3] * x_old[(i+1):3]) else 0
    x[i] <- (b[i] - s1 - s2) / A[i,i]
  }
  dx_inf <- max(abs(x - x_old))
  r_inf <- max(abs(b - A %*% x))
  cat(sprintf("x^(%d) = [%s]  ||dx||_inf = %.3e  ||r||_inf = %.3e\n",
              k, paste(sprintf("%.10f", x), collapse = ", "), dx_inf, r_inf))
}
```

```{r}
    cat("\n Se detectó crecimiento excesivo de las componentes -> el método está divergiendo.\n")
```


#### Ejercicio 3.
 3x1−0.5x2+0.6x3 = 5.24
 0.3x1−4x2−x3 = −0.387
 −0.7x1+2x2+7x3 = 14.803

```{r}
A <- matrix(c(3, -0.5,0.6,0.3,-4,-1,-0.7, 2, 7), nrow = 3, byrow = TRUE)
b <- c(5.24, -0.387, 14.803)
```

```{r}
x <- rep(0, 3)
cat("x^(0) =", paste(sprintf("%.8f", x), collapse=", "), "\n")
```

```{r}
# ---- Iteración 1 ----
cat("\n---- Iteración 1 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(1) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(1) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(1) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 2 ----
cat("\n---- Iteración 2 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(2) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(2) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(2) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 3 ----
cat("\n---- Iteración 3 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(3) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(3) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(3) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 4 ----
cat("\n---- Iteración 4 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(4) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(4) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(4) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 5 ----
cat("\n---- Iteración 5 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(5) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(5) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(5) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 6 ----
cat("\n---- Iteración 6 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(6) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(6) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(6) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 7 ----
cat("\n---- Iteración 7 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(7) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(7) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(7) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 8 ----
cat("\n---- Iteración 8 ----\n")
x_old <- x
x[1] <- (b[1] + 0.5*x_old[2] - 0.6*x_old[3]) / 3
cat(sprintf("x1^(8) = (5.24 + 0.5*%.8f - 0.6*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (b[2] - 0.3*x[1] + 1*x_old[3]) / (-4)
cat(sprintf("x2^(8) = (-0.387 - 0.3*%.8f + 1*%.8f)/-4 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] + 0.7*x[1] - 2*x[2]) / 7
cat(sprintf("x3^(8) = (14.803 + 0.7*%.8f - 2*%.8f)/7 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# Solución exacta
x_exacta <- solve(A, b)
cat("\nSolución exacta (solve):", paste(sprintf("%.8f", x_exacta), collapse=", "), "\n")
```

#### Ejercicio 4.

 5x1−0.2x2+x3 = 1.5
 0.1x1+3x2−0.5x3 = −2.7
 −0.3x1+x2−7x3 = 9.5
```{r} 
A <- matrix(c(5,-0.2,1,0.1,3,-0.5,-0.3,1,-7), nrow = 3, byrow = TRUE)

b <- c(1.5,-2.7,9.5)
```

```{r}
x <- rep(0, 3)
cat("x^(0) =", paste(sprintf("%.8f", x), collapse=", "), "\n")
```

```{r}
# ---- Iteración 1 ----
x1 <- (1.5 + 0.2*0 - 0)/5
x2 <- (-2.7 - 0.1*x1 + 0.5*0)/3
x3 <- (-9.5 + 0.3*x1 - x2)/-7
cat("\nIteración 1\n")
cat(sprintf("x1^(1) = %.8f\n", x1))
cat(sprintf("x2^(1) = %.8f\n", x2))
cat(sprintf("x3^(1) = %.8f\n", x3))
cat(sprintf("x^(1) = (%.8f, %.8f, %.8f)\n", x1, x2, x3))
```

```{r}
# ---- Iteración 2 ----
x1 <- (1.5 + 0.2*x2 - x3)/5
x2 <- (-2.7 - 0.1*x1 + 0.5*x3)/3
x3 <- (-9.5 + 0.3*x1 - x2)/-7
cat("\nIteración 2\n")
cat(sprintf("x1^(2) = %.8f\n", x1))
cat(sprintf("x2^(2) = %.8f\n", x2))
cat(sprintf("x3^(2) = %.8f\n", x3))
cat(sprintf("x^(2) = (%.8f, %.8f, %.8f)\n", x1, x2, x3))
```

```{r}
# ---- Iteración 3 ----
x1 <- (1.5 + 0.2*x2 - x3)/5
x2 <- (-2.7 - 0.1*x1 + 0.5*x3)/3
x3 <- (-9.5 + 0.3*x1 - x2)/-7
cat("\nIteración 3\n")
cat(sprintf("x1^(3) = %.8f\n", x1))
cat(sprintf("x2^(3) = %.8f\n", x2))
cat(sprintf("x3^(3) = %.8f\n", x3))
cat(sprintf("x^(3) = (%.8f, %.8f, %.8f)\n", x1, x2, x3))
```

```{r}
# ---- Iteración 4 ----
x1 <- (1.5 + 0.2*x2 - x3)/5
x2 <- (-2.7 - 0.1*x1 + 0.5*x3)/3
x3 <- (-9.5 + 0.3*x1 - x2)/-7
cat("\nIteración 4\n")
cat(sprintf("x1^(4) = %.8f\n", x1))
cat(sprintf("x2^(4) = %.8f\n", x2))
cat(sprintf("x3^(4) = %.8f\n", x3))
cat(sprintf("x^(4) = (%.8f, %.8f, %.8f)\n", x1, x2, x3))
```

```{r}
# ---- Iteración 5 ----
x1 <- (1.5 + 0.2*x2 - x3)/5
x2 <- (-2.7 - 0.1*x1 + 0.5*x3)/3
x3 <- (-9.5 + 0.3*x1 - x2)/-7
cat("\nIteración 5\n")
cat(sprintf("x1^(5) = %.8f\n", x1))
cat(sprintf("x2^(5) = %.8f\n", x2))
cat(sprintf("x3^(5) = %.8f\n", x3))
cat(sprintf("x^(5) = (%.8f, %.8f, %.8f)\n", x1, x2, x3))
```

```{r}
# ---- Iteración 6 ----
x1 <- (1.5 + 0.2*x2 - x3)/5
x2 <- (-2.7 - 0.1*x1 + 0.5*x3)/3
x3 <- (-9.5 + 0.3*x1 - x2)/-7
cat("\nIteración 6\n")
cat(sprintf("x1^(6) = %.8f\n", x1))
cat(sprintf("x2^(6) = %.8f\n", x2))
cat(sprintf("x3^(6) = %.8f\n", x3))
cat(sprintf("x^(6) = (%.8f, %.8f, %.8f)\n", x1, x2, x3))
```
 
#### Ejercicio 6.
 0.151+2.11x2+30.75x3 = −26.38
 0.64x1+1.21x2+2.05x3 = 1.01
 3.21x1+1.53x2+1.04x3 = 5.23

```{r}
A <- matrix(c(0, 2.11, 30.75,0.64, 1.21, 2.05,3.21, 1.53, 1.04), nrow=3, byrow=TRUE)
b <- c(-26.531, 1.01, 5.23)
```

```{r}
x <- rep(0, 3)   # x^(0) = [0,0,0]
cat("x^(0) =", paste(sprintf("%.6f", x), collapse=", "), "\n\n")
```

```{r}
# --- Iteración 1 ---
x_old <- x
x[2] <- (-26.531 - A[1,3]*x_old[3]) / 2.11
x[3] <- (5.23 - 3.21*x_old[1] - 1.53*x[2]) / 1.04
x[1] <- (1.01 - 1.21*x[2] - 2.05*x[3]) / 0.64
cat("Iteración 1: x1 =", sprintf("%.6f", x[1]),
    "x2 =", sprintf("%.6f", x[2]),
    "x3 =", sprintf("%.6f", x[3]), "\n\n")
```

```{r}
# --- Iteración 2 ---
x_old <- x
x[2] <- (-26.531 - A[1,3]*x_old[3]) / 2.11
x[3] <- (5.23 - 3.21*x_old[1] - 1.53*x[2]) / 1.04
x[1] <- (1.01 - 1.21*x[2] - 2.05*x[3]) / 0.64
cat("Iteración 2: x1 =", sprintf("%.6f", x[1]),
    "x2 =", sprintf("%.6f", x[2]),
    "x3 =", sprintf("%.6f", x[3]), "\n\n")
```

```{r}
x_old <- x
x[2] <- (-26.531 - A[1,3]*x_old[3]) / 2.11
x[3] <- (5.23 - 3.21*x_old[1] - 1.53*x[2]) / 1.04
x[1] <- (1.01 - 1.21*x[2] - 2.05*x[3]) / 0.64
cat("Iteración 3: x1 =", sprintf("%.6f", x[1]),
    "x2 =", sprintf("%.6f", x[2]),
    "x3 =", sprintf("%.6f", x[3]), "\n\n")
```

```{r}
# --- Iteración 4 ---
x_old <- x
x[2] <- (-26.531 - A[1,3]*x_old[3]) / 2.11
x[3] <- (5.23 - 3.21*x_old[1] - 1.53*x[2]) / 1.04
x[1] <- (1.01 - 1.21*x[2] - 2.05*x[3]) / 0.64
cat("Iteración 4: x1 =", sprintf("%.6f", x[1]),
    "x2 =", sprintf("%.6f", x[2]),
    "x3 =", sprintf("%.6f", x[3]), "\n\n")
```

```{r}
# --- Iteración 5 ---
x_old <- x
x[2] <- (-26.531 - A[1,3]*x_old[3]) / 2.11
x[3] <- (5.23 - 3.21*x_old[1] - 1.53*x[2]) / 1.04
x[1] <- (1.01 - 1.21*x[2] - 2.05*x[3]) / 0.64
cat("Iteración 5: x1 =", sprintf("%.6f", x[1]),
    "x2 =", sprintf("%.6f", x[2]),
    "x3 =", sprintf("%.6f", x[3]), "\n\n")
```

```{r}
cat(" Se observa crecimiento excesivo: el método está divergiendo.\n")
```


#### Ejercicio 9.
 3x−0.1y−0.2z = 7.85
 0.1x+7y−0.3z = −19.3
 0.3x1−0.2x2+10x3=71.4

```{r}
A <- matrix(c(3, -0.1, -0.2,0.1, 7, -0.3,0.3, -0.2, 10), nrow=3, byrow=TRUE)
b <- c(7.85, -19.3, 71.4)
```

```{r}
x <- rep(0,3)  
cat("x^(0) =", paste(sprintf("%.8f", x), collapse=", "), "\n")
```

```{r}
# ---- Iteración 1 ----
x_old <- x
cat("\nIteración 1\n")

x[1] <- (b[1] + 0.1*x_old[2] + 0.2*x_old[3])/A[1,1]
cat(sprintf("x1^(1) = (7.85 + 0.1*0 + 0.2*0)/3 = %.8f\n", x[1]))

x[2] <- (-19.3 - 0.1*x[1] + 0.3*x_old[3])/A[2,2]
cat(sprintf("x2^(1) = (-19.3 - 0.1*%.8f + 0.3*0)/7 = %.8f\n", x[1], x[2]))

x[3] <- (b[3] - 0.3*x[1] + 0.2*x[2])/A[3,3]
cat(sprintf("x3^(1) = (71.4 - 0.3*%.8f + 0.2*%.8f)/10 = %.8f\n", x[1], x[2], x[3]))

cat(sprintf("x^(1) = (%.8f, %.8f, %.8f)\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 2 ----
x_old <- x
cat("\nIteración 2\n")

x[1] <- (b[1] + 0.1*x_old[2] + 0.2*x_old[3])/A[1,1]
cat(sprintf("x1^(2) = (7.85 + 0.1*%.8f + 0.2*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (-19.3 - 0.1*x[1] + 0.3*x_old[3])/A[2,2]
cat(sprintf("x2^(2) = (-19.3 - 0.1*%.8f + 0.3*%.8f)/7 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] - 0.3*x[1] + 0.2*x[2])/A[3,3]
cat(sprintf("x3^(2) = (71.4 - 0.3*%.8f + 0.2*%.8f)/10 = %.8f\n", x[1], x[2], x[3]))

cat(sprintf("x^(2) = (%.8f, %.8f, %.8f)\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 3 ----
x_old <- x
cat("\nIteración 3\n")

x[1] <- (b[1] + 0.1*x_old[2] + 0.2*x_old[3])/A[1,1]
cat(sprintf("x1^(3) = (7.85 + 0.1*%.8f + 0.2*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (-19.3 - 0.1*x[1] + 0.3*x_old[3])/A[2,2]
cat(sprintf("x2^(3) = (-19.3 - 0.1*%.8f + 0.3*%.8f)/7 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] - 0.3*x[1] + 0.2*x[2])/A[3,3]
cat(sprintf("x3^(3) = (71.4 - 0.3*%.8f + 0.2*%.8f)/10 = %.8f\n", x[1], x[2], x[3]))

cat(sprintf("x^(3) = (%.8f, %.8f, %.8f)\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 4 ----
x_old <- x
cat("\nIteración 4\n")

x[1] <- (b[1] + 0.1*x_old[2] + 0.2*x_old[3])/A[1,1]
cat(sprintf("x1^(4) = (7.85 + 0.1*%.8f + 0.2*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (-19.3 - 0.1*x[1] + 0.3*x_old[3])/A[2,2]
cat(sprintf("x2^(4) = (-19.3 - 0.1*%.8f + 0.3*%.8f)/7 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] - 0.3*x[1] + 0.2*x[2])/A[3,3]
cat(sprintf("x3^(4) = (71.4 - 0.3*%.8f + 0.2*%.8f)/10 = %.8f\n", x[1], x[2], x[3]))

cat(sprintf("x^(4) = (%.8f, %.8f, %.8f)\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 5 ----
x_old <- x
cat("\nIteración 5\n")

x[1] <- (b[1] + 0.1*x_old[2] + 0.2*x_old[3])/A[1,1]
cat(sprintf("x1^(5) = (7.85 + 0.1*%.8f + 0.2*%.8f)/3 = %.8f\n", x_old[2], x_old[3], x[1]))

x[2] <- (-19.3 - 0.1*x[1] + 0.3*x_old[3])/A[2,2]
cat(sprintf("x2^(5) = (-19.3 - 0.1*%.8f + 0.3*%.8f)/7 = %.8f\n", x[1], x_old[3], x[2]))

x[3] <- (b[3] - 0.3*x[1] + 0.2*x[2])/A[3,3]
cat(sprintf("x3^(5) = (71.4 - 0.3*%.8f + 0.2*%.8f)/10 = %.8f\n", x[1], x[2], x[3]))

cat(sprintf("x^(5) = (%.8f, %.8f, %.8f)\n", x[1], x[2], x[3]))
```

```{r}
# ---- Solución final aproximada ----
cat("\nSolución aproximada después de 5 iteraciones:\n")
cat(sprintf("x ≈ %.8f, y ≈ %.8f, z ≈ %.8f\n", x[1], x[2], x[3]))
```
                
#### Ejercicio 10.
 17x1−2x2−3x3=500
 −5x1+21x2−2x3 = 200
 −5x1−5x2+22x3 = 30

```{r}
A <- matrix(c(17,-2,-3,-5, 21,-2,-5,-5,22), nrow = 3, byrow = TRUE)
b <- c(500, 200, 30)
```

```{r}
x <- rep(0,3)
cat("x^(0) =", paste(sprintf("%.8f", x), collapse=", "), "\n")
```

```{r}
# ---- Iteración 1 ----
x_old <- x
cat("\nIteración 1\n")
x[1] <- (b[1] + 2*x_old[2] + 3*x_old[3])/17
cat(sprintf("x1^(1) = (500 + 2*0 + 3*0)/17 = %.8f\n", x[1]))
x[2] <- (b[2] + 5*x[1] + 2*x_old[3])/21
cat(sprintf("x2^(1) = (200 + 5*%.8f + 2*0)/21 = %.8f\n", x[1], x[2]))
x[3] <- (b[3] + 5*x[1] + 5*x[2])/22
cat(sprintf("x3^(1) = (30 + 5*%.8f + 5*%.8f)/22 = %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 2 ----
x_old <- x
cat("\nIteración 2\n")
x[1] <- (b[1] + 2*x_old[2] + 3*x_old[3])/17
x[2] <- (b[2] + 5*x[1] + 2*x_old[3])/21
x[3] <- (b[3] + 5*x[1] + 5*x[2])/22
cat(sprintf("x^(2) = %.8f, %.8f, %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 3 ----
x_old <- x
cat("\nIteración 3\n")
x[1] <- (b[1] + 2*x_old[2] + 3*x_old[3])/17
x[2] <- (b[2] + 5*x[1] + 2*x_old[3])/21
x[3] <- (b[3] + 5*x[1] + 5*x[2])/22
cat(sprintf("x^(3) = %.8f, %.8f, %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 4 ----
x_old <- x
cat("\nIteración 4\n")
x[1] <- (b[1] + 2*x_old[2] + 3*x_old[3])/17
x[2] <- (b[2] + 5*x[1] + 2*x_old[3])/21
x[3] <- (b[3] + 5*x[1] + 5*x[2])/22
cat(sprintf("x^(4) = %.8f, %.8f, %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteración 6 ----
x_old <- x
cat("\nIteración 5\n")
x[1] <- (b[1] + 2*x_old[2] + 3*x_old[3])/17
x[2] <- (b[2] + 5*x[1] + 2*x_old[3])/21
x[3] <- (b[3] + 5*x[1] + 5*x[2])/22
cat(sprintf("x^(5) = %.8f, %.8f, %.8f\n", x[1], x[2], x[3]))
```

```{r}
# ---- Iteraciones de 6 a 10 ----
for(k in 6:10){
  x_old <- x
  x[1] <- (b[1] + 2*x_old[2] + 3*x_old[3])/17
  x[2] <- (b[2] + 5*x[1] + 2*x_old[3])/21
  x[3] <- (b[3] + 5*x[1] + 5*x[2])/22
  dx_inf <- max(abs(x - x_old))
  cat(sprintf("\nIteración %d: x = %.8f, %.8f, %.8f | ||dx||_inf = %.8e", k, x[1], x[2], x[3], dx_inf))
  if(dx_inf < 1e-6) cat(" <- Convergencia alcanzada")
  cat("\n")
}
```

```{r}
# Solución exacta opcional
x_exacta <- solve(A,b)
cat("\nSolución exacta: ", paste(sprintf("%.8f", x_exacta), collapse=", "), "\n")
```


![Ejercicio de metodode Gauss-Jordan](Gauss Seidel.jpeg){width=550}
![Ejercicio de metodode Gauss-Jordan](Gauss S.jpeg){width=550}



### Gauss-Jacobi

#### Ejercicio 1.
A=( 10 2 −1 0| 26
    1 20 −2 3| −15
    −2 1 30 0| 53
    1  2 3 20|47)
  
```{r}
A <- matrix(c(
    10, 2, -1, 0,
    1, 20, -2, 3,
    -2, 1, 30, 0,
    1, 2, 3, 20
), nrow = 4, byrow = TRUE)
b <- c(26, -15, 53, 47)
```

```{r}
gauss_jacobi_iteracion <- function(x_actual) {

    x_siguiente <- numeric(4)
    
    x_siguiente[1] <- (b[1] - A[1, 2] * x_actual[2] - A[1, 3] * x_actual[3] - A[1, 4] * x_actual[4]) / A[1, 1]
    
    x_siguiente[2] <- (b[2] - A[2, 1] * x_actual[1] - A[2, 3] * x_actual[3] - A[2, 4] * x_actual[4]) / A[2, 2]
    
    x_siguiente[3] <- (b[3] - A[3, 1] * x_actual[1] - A[3, 2] * x_actual[2] - A[3, 4] * x_actual[4]) / A[3, 3]
    
    x_siguiente[4] <- (b[4] - A[4, 1] * x_actual[1] - A[4, 2] * x_actual[2] - A[4, 3] * x_actual[3]) / A[4, 4]
    
    return(x_siguiente)
}
```

```{r}
x_k <- c(0, 0, 0, 0)
cat(sprintf("Vector Inicial (k=0): %s\n", paste(round(x_k, 5), collapse = ", ")))
```

```{r}
historial <- list(x_k)
TOLERANCIA <- 1e-4 
```

```{r}
# --- ITERACIÓN 1  ---
x_k_anterior <- x_k
x_k <- gauss_jacobi_iteracion(x_k_anterior)
error_inf <- max(abs(x_k - x_k_anterior))
historial[[2]] <- x_k
cat(sprintf("Iteración 1: %s | Error: %.6f\n", paste(round(x_k, 5), collapse = ", "), error_inf))
```

```{r}
# --- ITERACIÓN 2 ---
x_k_anterior <- x_k
x_k <- gauss_jacobi_iteracion(x_k_anterior)
error_inf <- max(abs(x_k - x_k_anterior))
historial[[3]] <- x_k
cat(sprintf("Iteración 2: %s | Error: %.6f\n", paste(round(x_k, 5), collapse = ", "), error_inf))
```

```{r}
# --- ITERACIÓN 3  ---
x_k_anterior <- x_k
x_k <- gauss_jacobi_iteracion(x_k_anterior)
error_inf <- max(abs(x_k - x_k_anterior))
historial[[4]] <- x_k
cat(sprintf("Iteración 3: %s | Error: %.6f\n", paste(round(x_k, 5), collapse = ", "), error_inf))
```

```{r}
# --- ITERACIÓN 4  ---
x_k_anterior <- x_k
x_k <- gauss_jacobi_iteracion(x_k_anterior)
error_inf <- max(abs(x_k - x_k_anterior))
historial[[5]] <- x_k
cat(sprintf("Iteración 4: %s | Error: %.6f\n", paste(round(x_k, 5), collapse = ", "), error_inf))
```

```{r}
# --- ITERACIÓN 5  ---
x_k_anterior <- x_k
x_k <- gauss_jacobi_iteracion(x_k_anterior)
error_inf <- max(abs(x_k - x_k_anterior))
historial[[6]] <- x_k
cat(sprintf("Iteración 5: %s | Error: %.6f\n", paste(round(x_k, 5), collapse = ", "), error_inf))
```

```{r}
# --- ITERACIÓN 6 ---
x_k_anterior <- x_k
x_k <- gauss_jacobi_iteracion(x_k_anterior)
error_inf <- max(abs(x_k - x_k_anterior))
historial[[7]] <- x_k
cat(sprintf("Iteración 6: %s | Error: %.6f\n", paste(round(x_k, 5), collapse = ", "), error_inf))
```

```{r}
cat(sprintf("Tolerancia para convergencia: %.4f\n", TOLERANCIA))
if (error_inf <= TOLERANCIA) {
    cat(sprintf("El sistema converge en la Iteración 6, ya que el error (%.6f) es menor o igual a la tolerancia.\n", error_inf))
} else {
    cat(sprintf("El sistema aún no converge a la Iteración 6. Se requiere más iteraciones.\n"))
}
```

      
#### Ejercicio 3.
   A=( 8 2 3| 51
       2 5 1| 23
      −3 1 6| 20)

```{r}
f_x <- function(y_k, z_k) {
  return((51 - 2*y_k - 3*z_k) / 8)
}
```

```{r}
f_y <- function(x_k, z_k) {
  return((23 - 2*x_k - z_k) / 5)
}
```

```{r}
f_z <- function(x_k, y_k) {
  return((20 + 3*x_k - y_k) / 6)
}
```

```{r}
x_k_prev <- 0
y_k_prev <- 0
z_k_prev <- 0
```

```{r}
resultados <- data.frame(
  k = 0, 
  x = x_k_prev, 
  y = y_k_prev, 
  z = z_k_prev
)
```

```{r}
num_iteraciones <- 5

for (k in 1:num_iteraciones) {
  
  x_k_next <- f_x(y_k_prev, z_k_prev)
  y_k_next <- f_y(x_k_prev, z_k_prev)
  z_k_next <- f_z(x_k_prev, y_k_prev)
  

  resultados <- rbind(resultados, data.frame(
    k = k, 
    x = x_k_next, 
    y = y_k_next, 
    z = z_k_next
  ))
  
  
  x_k_prev <- x_k_next
  y_k_prev <- y_k_next
  z_k_prev <- z_k_next
}
```

```{r}
cat("RESULTADOS DEL MÉTODO DE GAUSS-JACOBI\n")
print(round(resultados, 4))
cat("ANÁLISIS DE CONVERGENCIA\n")
```

```{r}
ultima_iteracion <- resultados[nrow(resultados),]
penultima_iteracion <- resultados[nrow(resultados)-1,]
```

```{r}
dif_x <- abs(ultima_iteracion$x - penultima_iteracion$x)
dif_y <- abs(ultima_iteracion$y - penultima_iteracion$y)
dif_z <- abs(ultima_iteracion$z - penultima_iteracion$z)
```

```{r}
cat(paste("Diferencia (Error aproximado) entre Iteración", num_iteraciones, "y", num_iteraciones-1, ":\n"))
cat(paste("  |x|: ", round(dif_x, 4), "\n"))
cat(paste("  |y|: ", round(dif_y, 4), "\n"))
cat(paste("  |z|: ", round(dif_z, 4), "\n"))

cat("\nConclusión: Los valores tienden rápidamente hacia (4, 2, 5).\n")
cat("El sistema converge en la **Iteración 5** para una tolerancia de 0.04 o menos.\n")
```

#### Ejercicio 4.

A= (2 −1  1 3| 10
    2  2  2 2| 1
   −1 −1  2 2| −5
    3  1 −1 4| 6)

```{r}
A <- matrix(c(2, -1, 1, 3,
              2, 2, 2, 2,
              -1, -1, 2, 2,
              3, 1, -1, 4),
            nrow = 4, byrow = TRUE)
b <- c(10, 1, -5, 6)
```

```{r}
x_k <- c(x1 = 0, x2 = 0, x3 = 0, x4 = 0)
```

```{r}
gauss_jacobi_iteration <- function(x_old) {

  x1_new <- (10 + x_old["x2"] - x_old["x3"] - 3 * x_old["x4"]) / 2
  
  x2_new <- (1 - 2 * x_old["x1"] - 2 * x_old["x3"] - 2 * x_old["x4"]) / 2
  
  x3_new <- (-5 + x_old["x1"] + x_old["x2"] - 2 * x_old["x4"]) / 2
  
  x4_new <- (6 - 3 * x_old["x1"] - x_old["x2"] + x_old["x3"]) / 4
  

  return(c(x1 = x1_new, x2 = x2_new, x3 = x3_new, x4 = x4_new))
}
```

```{r}
cat("--- ITERACIÓN 0 ---\n")
print(x_k)
```

```{r}
# --- Iteración 1 ---
x_k_old <- x_k # Guardamos el valor de k=0
x_k <- gauss_jacobi_iteration(x_k_old) 
cat("\n--- ITERACIÓN 1 (Usando valores de I0) ---\n")
print(x_k)
error_inf <- max(abs(x_k - x_k_old))
cat(paste("Error Máximo (Norma Infinito):", round(error_inf, 4), "\n"))
```

```{r}
# --- Iteración 2 ---
x_k_old <- x_k # Guardamos el valor de k=1
x_k <- gauss_jacobi_iteration(x_k_old) 
cat("\n--- ITERACIÓN 2 (Usando valores de I1) ---\n")
print(x_k)
error_inf <- max(abs(x_k - x_k_old))
cat(paste("Error Máximo (Norma Infinito):", round(error_inf, 4), "\n"))
```

```{r}
# --- Iteración 3 ---
x_k_old <- x_k # Guardamos el valor de k=2
x_k <- gauss_jacobi_iteration(x_k_old)
cat("\n--- ITERACIÓN 3 (Usando valores de I2) ---\n")
print(x_k)
error_inf <- max(abs(x_k - x_k_old))
cat(paste("Error Máximo (Norma Infinito):", round(error_inf, 4), "\n"))
```

```{r}
# --- Iteración 4 ---
x_k_old <- x_k # Guardamos el valor de k=3
x_k <- gauss_jacobi_iteration(x_k_old)
cat("\n--- ITERACIÓN 4 (Usando valores de I3) ---\n")
print(x_k)
error_inf <- max(abs(x_k - x_k_old))
cat(paste("Error Máximo (Norma Infinito):", round(error_inf, 4), "\n"))
```

```{r}
cat("\nEl sistema está DIVERGIENDO debido a la falta de dominancia diagonal.\n")
cat("Por lo tanto, NO CONVERGE en la iteración 4 ni en las siguientes, \n")
cat("y el método de Gauss-Jacobi no es adecuado para esta matriz.\n")
```

#### Ejercicio 5.
   A=( 3 1 1 −1| 5
       0 2 1  4| 0
       1 1 −1 9| 1
       2 4 6  3| 0)

```{r}
A <- matrix(c(
  3, 1, 1, -1,
  0, 2, 1, 4,
  1, 1, -1, 9,
  2, 4, 6, 3
), nrow = 4, byrow = TRUE)

b <- c(5, 0, 1, 0)
```

```{r}
print("Matriz A:")
print(A)
print("Vector b:")
print(b)
```

```{r}
x_k_old <- c(0, 0, 0, 0)
print(paste("Aproximación Inicial (k=0):", paste(round(x_k_old, 5), collapse = ", ")))
```

```{r}
gauss_jacobi_iteracion <- function(x_prev, A, b) {
  
  n <- length(b) 
  x_k_new <- numeric(n)
  
  for (i in 1:n) {
    sum_terms <- 0
    
    for (j in 1:n) {
      if (i != j) {
        sum_terms <- sum_terms + A[i, j] * x_prev[j]
      }
    }

    if (A[i, i] == 0) {
      stop("Error: El método de Jacobi requiere que los elementos de la diagonal sean distintos de cero.")
    }
    
    x_k_new[i] <- (b[i] - sum_terms) / A[i, i]
  }
  
  return(x_k_new)
}
```

```{r}
calcular_error <- function(x_new, x_old) {
  error_abs <- sqrt(sum((x_new - x_old)^2)) 
  norm_new <- sqrt(sum(x_new^2))            
  
  if (norm_new > 1e-10) {
    return(error_abs / norm_new)
  } else {
    return(error_abs)
  }
}
```

```{r}
# --- Iteración 1 (k=1) ---
x_1 <- gauss_jacobi_iteracion(x_k_old, A, b)
error_1 <- calcular_error(x_1, x_k_old)
cat("\nIteración 1 (k=1):\n")
cat("  x(1) =", paste(round(x_1, 5), collapse = ", "), "\n")
cat("  Error relativo (con x(0)):", round(error_1, 6), "\n")
```

```{r}
# --- Iteración 2 (k=2) ---
x_2 <- gauss_jacobi_iteracion(x_1, A, b)
error_2 <- calcular_error(x_2, x_1)
cat("\nIteración 2 (k=2):\n")
cat("  x(2) =", paste(round(x_2, 5), collapse = ", "), "\n")
cat("  Error relativo (con x(1)):", round(error_2, 6), "\n")
```

```{r}
# --- Iteración 3 (k=3) ---
x_3 <- gauss_jacobi_iteracion(x_2, A, b)
error_3 <- calcular_error(x_3, x_2)
cat("\nIteración 3 (k=3):\n")
cat("  x(3) =", paste(round(x_3, 5), collapse = ", "), "\n")
cat("  Error relativo (con x(2)):", round(error_3, 6), "\n")
```

```{r}
cat("\n\nEl sistema muestra **divergencia** a partir de la Iteración 3.")
cat("\nEl error relativo aumentó significativamente de 1.25 (k=2) a 3.40 (k=3).")
cat("\nEsto se debe a que la matriz A **no cumple el criterio de dominancia diagonal estricta**.")
```


#### Ejercicio 6.
 
  A=( 10 −1 2  0 | 6
      −1 11 −1 3 |25
       2 −1 10 −1|−11
       0  2 −1  8|15)
       
```{r}
A <- matrix(c(
  10, -1,  2,  0,
  -1, 11, -1,  3,
   2, -1, 10, -1,
   0,  2, -1,  8
), nrow = 4, byrow = TRUE)
b <- c(6, 25, -11, 15)
```

```{r}
gauss_jacobi <- function(A, b, tol = 1e-3, max_iter = 100, x0 = rep(0, nrow(A))) {
  n <- nrow(A)
  x_anterior <- x0
  
  error_max <- Inf
  
  for (k in 1:max_iter) {
    x_nuevo <- numeric(n)
    
    for (i in 1:n) {
      suma_otros <- sum(A[i, ] * x_anterior) - A[i, i] * x_anterior[i]
      
      x_nuevo[i] <- (b[i] - suma_otros) / A[i, i]
    }
    
    error_max <- max(abs(x_nuevo - x_anterior))
    
    if (error_max < tol) {
      cat("\nEl sistema CONVERGIÓ en la iteración", k, "con un error máximo de", error_max, "\n")
      
      cat("\nSolución Aproximada:\n")
      print(x_nuevo)
      
      return(invisible(x_nuevo))
    }
    
    x_anterior <- x_nuevo
  }
  
  cat("\nEl método NO CONVERGIÓ después de", max_iter, "iteraciones (Error máximo:", error_max, ")\n")
  return(invisible(x_nuevo))
}
```

```{r}
solucion_gj <- gauss_jacobi(A, b, tol = 1e-3)
```

```{r}
solucion_exacta <- solve(A, b)
cat("\n\nSolución Exacta (por método directo):\n")
print(solucion_exacta)
```


#### Ejercicio  8.
 −4x1+14x2=10
 −5x1+13x2 =8
 −x1+2x3 = 1
 
```{r}
# El sistema se reescribe para el método de Jacobi:
# x1(k+1) = -2.5 + 3.5*x2(k)
# x2(k+1) = (8 + 5*x1(k)) / 13
# x3(k+1) = 0.5 + 0.5*x1(k)

f1 <- function(x2_prev) {
  -2.5 + 3.5 * x2_prev
}
```

```{r}
f2 <- function(x1_prev) {
  (8 + 5 * x1_prev) / 13 # Usamos la fracción para mayor precisión
}
```

```{r}
f3 <- function(x1_prev) {
  0.5 + 0.5 * x1_prev
}
```

```{r}
x_k_prev <- c(x1 = 0, x2 = 0, x3 = 0)
cat("--- Valores Iniciales (k=0) ---\n")
print(x_k_prev)
```

```{r}
resultados_iteracion <- data.frame(
  k = 0,
  x1 = x_k_prev["x1"],
  x2 = x_k_prev["x2"],
  x3 = x_k_prev["x3"]
)
```

```{r}
# --- ITERACIÓN 1 (k=1) ---
cat("\n--- ITERACIÓN 1 ---\n")
x1_k1 <- f1(x_k_prev["x2"])
x2_k1 <- f2(x_k_prev["x1"])
x3_k1 <- f3(x_k_prev["x1"])

x_k_next <- c(x1 = x1_k1, x2 = x2_k1, x3 = x3_k1)
print(x_k_next)
```

```{r}
x_k_prev <- x_k_next
resultados_iteracion[2,] <- c(1, x_k_next)
```

```{r}
# --- ITERACIÓN 2 (k=2) ---
cat("\n--- ITERACIÓN 2 ---\n")
x1_k2 <- f1(x_k_prev["x2"])
x2_k2 <- f2(x_k_prev["x1"])
x3_k2 <- f3(x_k_prev["x1"])

x_k_next <- c(x1 = x1_k2, x2 = x2_k2, x3 = x3_k2)
print(x_k_next)
```

```{r}
x_k_prev <- x_k_next
resultados_iteracion[3,] <- c(2, x_k_next)
```

```{r}
# --- ITERACIÓN 3 (k=3) ---
cat("\n--- ITERACIÓN 3 ---\n")
x1_k3 <- f1(x_k_prev["x2"])
x2_k3 <- f2(x_k_prev["x1"])
x3_k3 <- f3(x_k_prev["x1"])

x_k_next <- c(x1 = x1_k3, x2 = x2_k3, x3 = x3_k3)
print(x_k_next)
```

```{r}
x_k_prev <- x_k_next
resultados_iteracion[4,] <- c(3, x_k_next)
```

```{r}
# --- ITERACIÓN 4 (k=4) ---
cat("\n--- ITERACIÓN 4 ---\n")
x1_k4 <- f1(x_k_prev["x2"])
x2_k4 <- f2(x_k_prev["x1"])
x3_k4 <- f3(x_k_prev["x1"])

x_k_next <- c(x1 = x1_k4, x2 = x2_k4, x3 = x3_k4)
print(x_k_next)
```

```{r}
x_k_prev <- x_k_next
resultados_iteracion[5,] <- c(4, x_k_next)
```

```{r}
cat("El sistema **NO converge** con el método de Gauss-Jacobi en estas iteraciones.\n")
cat("Los valores de x1, x2 y x3 están oscilando y sus magnitudes están aumentando, lo que indica **DIVERGENCIA**.\n")
```
 
#### Ejercicio 10.
 6x1−2x2+2x3+4x4 = 10
 12x1−8x2+6x3+10x4 = 20
 3x1−13x2+9x3+3x4 = 2
 −6x1+4x2+x3−18x4 = −19

```{r}
# Sistema reordenado para intentar la convergencia:
# 1. 12x1 - 8x2 + 6x3 + 10x4 = 20
# 2. 3x1 - 13x2 + 9x3 + 3x4 = 2
# 3. 6x1 - 2x2 + 2x3 + 4x4 = 10
# 4. -6x1 + 4x2 + x3 - 18x4 = -19
```

```{r}
jacobi_iteracion <- function(x_k) {

  x1_nuevo <- (20 + 8 * x_k[2] - 6 * x_k[3] - 10 * x_k[4]) / 12
  
  x2_nuevo <- (-2 + 3 * x_k[1] + 9 * x_k[3] + 3 * x_k[4]) / 13
  
  x3_nuevo <- (10 - 6 * x_k[1] + 2 * x_k[2] - 4 * x_k[4]) / 2
  
  x4_nuevo <- (19 - 6 * x_k[1] + 4 * x_k[2] + x_k[3]) / 18
  
  return(c(x1_nuevo, x2_nuevo, x3_nuevo, x4_nuevo))
}
```

```{r}
x_k <- c(0, 0, 0, 0)
cat("--- Iteración k = 0 (Inicial) ---\n")
print(x_k)
```

```{r}
# --- ITERACIÓN k = 1 ---
cat("--- Cálculo de la Iteración k = 1 ---\n")

x_k_mas_1 <- jacobi_iteracion(x_k)

cat(sprintf("x1(1) = (20 + 8*(%.6f) - 6*(%.6f) - 10*(%.6f)) / 12 = %.6f\n", x_k[2], x_k[3], x_k[4], x_k_mas_1[1]))
cat(sprintf("x2(1) = (-2 + 3*(%.6f) + 9*(%.6f) + 3*(%.6f)) / 13 = %.6f\n", x_k[1], x_k[3], x_k[4], x_k_mas_1[2]))
cat(sprintf("x3(1) = (10 - 6*(%.6f) + 2*(%.6f) - 4*(%.6f)) / 2  = %.6f\n", x_k[1], x_k[2], x_k[4], x_k_mas_1[3]))
cat(sprintf("x4(1) = (19 - 6*(%.6f) + 4*(%.6f) + (%.6f)) / 18   = %.6f\n", x_k[1], x_k[2], x_k[3], x_k_mas_1[4]))
```

```{r}
x_k <- x_k_mas_1 
cat("\nResultado x^(1):\n")
print(x_k)
```

```{r}
# --- ITERACIÓN k = 2 ---
cat("--- Cálculo de la Iteración k = 2 ---\n")
x_k_mas_1 <- jacobi_iteracion(x_k)

cat(sprintf("x1(2) = (20 + 8*(%.6f) - 6*(%.6f) - 10*(%.6f)) / 12 = %.6f\n", x_k[2], x_k[3], x_k[4], x_k_mas_1[1]))
cat(sprintf("x2(2) = (-2 + 3*(%.6f) + 9*(%.6f) + 3*(%.6f)) / 13 = %.6f\n", x_k[1], x_k[3], x_k[4], x_k_mas_1[2]))
cat(sprintf("x3(2) = (10 - 6*(%.6f) + 2*(%.6f) - 4*(%.6f)) / 2  = %.6f\n", x_k[1], x_k[2], x_k[4], x_k_mas_1[3]))
cat(sprintf("x4(2) = (19 - 6*(%.6f) + 4*(%.6f) + (%.6f)) / 18   = %.6f\n", x_k[1], x_k[2], x_k[3], x_k_mas_1[4]))

x_k <- x_k_mas_1 
cat("\nResultado x^(2):\n")
print(x_k)
```

```{r}
cat("El sistema **NO converge** con el método de Gauss-Jacobi en estas iteraciones.\n")
``` 


![Ejercicio de metodode Gauss-Jordan](Gauss Jacobi.jpeg){width=550}
![Ejercicio de metodode Gauss-Jordan](Gauss J.jpeg){width=550}

# Raices de funciones

### Método de Bisección

#### 9. f(x) = x^3 − 5x + 1. [a, b] = [0, 1].

```{r}
biseccion <- function(f, a, b, tol = 1e-6, iter_max = 100){
if(f(a)*f(b) > 0){
cat("Error: no hay cambio de signo en [a,b].\n")
return(NA)
}
  
iter <- 0
error <- abs(b - a)
while(error > tol && iter < iter_max){
c <- (a + b)/2
if(f(a)*f(c) < 0){
b <- c
} else {
a <- c
}

error <- abs(b - a)
iter <- iter + 1
}

cat("Raíz aproximada:", c, "\n")
cat("Iteraciones:", iter, "\n")
return(c)
}

f <- function(x) x^3 - 5*x + 1

biseccion(f, a = 0, b = 1)

```


#### 11. f(x) = −2x^4 + 4x^3 + 6x^2 − 3x + 2. [a, b] =[−2, −1]

```{r}
biseccion <- function(f, a, b, tol = 1e-6, iter_max = 100){
  if(f(a)*f(b) > 0){
    cat("Error: no hay cambio de signo en [a,b].\n")
    return(NA)
  }
  
  iter <- 0
  error <- abs(b - a)
  c <- (a + b)/2 # Inicializar c
  
  while(error > tol && iter < iter_max){
    c <- (a + b)/2
    if(f(a)*f(c) < 0){
      b <- c
    } else {
      a <- c
    }
    error <- abs(b - a)
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", c, "\n")
  cat("Iteraciones:", iter, "\n")
  return(c)
}

f <- function(x) -2*x^4 + 4*x^3 + 6*x^2 - 3*x + 2

biseccion(f, a = -2, b = -1)
```
#### 13. f(x) = x^4 + 2x^3 − 10x^2 − x + 5. [a, b] = [0, 1]

```{r}
biseccion <- function(f, a, b, tol = 1e-6, iter_max = 100){
  
  if(f(a)*f(b) > 0){
    cat("Error: no hay cambio de signo en [a,b].\n")
    return(NA)
  }
  
  iter <- 0
  error <- abs(b - a)
  
  
  while(error > tol && iter < iter_max){
    
    c <- (a + b)/2
    
    
    if(f(a)*f(c) < 0){
      b <- c 
    } else {
      a <- c 
    }
    
    
    error <- abs(b - a)
    iter <- iter + 1
  }
  
  
  cat("Raíz aproximada:", c, "\n")
  cat("Iteraciones:", iter, "\n")
  return(c)
}


f_ejercicio13 <- function(x) x^4 + 2*x^3 - 10*x^2 - x + 5

biseccion(f_ejercicio13, a = 0, b = 1)
```

#### 15. f(x) = 7 − 4 e^−0.9x+0.2. [a, b] = [−2, 0].

```{r}
f <- function(x) 7 - 4 * exp(-0.9 * x + 0.2)

biseccion <- function(f, a, b, tol = 1e-6, iter_max = 100){
  if(f(a)*f(b) > 0){
    cat("Error: no hay cambio de signo en [a,b].\n")
    return(NA)
  }
  iter <- 0
  error <- abs(b - a)
  
  c <- (a + b) / 2 
  
  while(error > tol && iter < iter_max){
    c <- (a + b)/2
    if(f(a)*f(c) < 0){
      b <- c
    } else {
      a <- c
    }
    error <- abs(b - a)
    iter <- iter + 1
  }
  cat("Raíz aproximada:", c, "\n")
  cat("Iteraciones:", iter, "\n")
  return(c)
}

biseccion(f, a = -2, b = 0)
```

#### 17. f(x) = (2x+1.4) cos(3x+π/4). [a, b] = [0.1, 0.6].

```{r}
biseccion <- function(f, a, b, tol = 1e-6, iter_max = 100){
if(f(a)*f(b) > 0){
cat("Error: no hay cambio de signo en [a,b].\n")
return(NA)
}
iter <- 0
error <- abs(b - a)
while(error > tol && iter < iter_max){
c <- (a + b)/2
if(f(a)*f(c) < 0){
b <- c
} else {
a <- c
}
error <- abs(b - a)
iter <- iter + 1
}
cat("Raíz aproximada:", c, "\n")
cat("Iteraciones:", iter, "\n")
return(c)
}

f <- function(x) (2*x + 1.4) * cos(3*x + pi/4)

biseccion(f, a = 0.1, b = 0.6)
```

### Método de la Secante
#### 1. f(x) = x^2 − 2x − 3, con x0 = 0, x1 = 3

```{r}
secante <- function(f, x0, x1, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  while(error > tol && iter < iter_max){
    fx0 <- f(x0)
    fx1 <- f(x1)
    if(abs(fx1 - fx0) < 1e-12){
      cat("Error: División por cero (f(x1) - f(x0) approxx 0)\n")
      return(NA)
    }
    x2 <- x1 - fx1 * (x1 - x0) / (fx1 - fx0)
    error <- abs(x2 - x1)
    x0 <- x1
    x1 <- x2
    iter <- iter + 1
  }
  cat("Raíz aproximada:", x2, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x2)
}

f_ejercicio <- function(x) {
  return(x^2 - 2*x - 3)
}

x_inicial_0 <- 0
x_inicial_1 <- 3

resultado <- secante(f_ejercicio, x_inicial_0, x_inicial_1)
```

#### 3. f(x) = 2x^2 − 5 ∗ x + 3, x0 = −1, x1 = 2
```{r}
f <- function(x) {
  
  return(2 * x^2 - 5 * x + 3)
}

secante <- function(f, x0, x1, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    fx0 <- f(x0)
    fx1 <- f(x1)
    
    
    if(abs(fx1 - fx0) < 1e-12){
      cat("Error: División por cero (f(x1) - f(x0) approx 0)\n")
      return(NA)
    }
    
    x2 <- x1 - fx1 * (x1 - x0) / (fx1 - fx0)
    
    error <- abs(x2 - x1)
    x0 <- x1
    x1 <- x2
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", x2, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x2)
}

x0_inicial <- -1
x1_inicial <- 2
 3
resultado <- secante(f, x0_inicial, x1_inicial)
```

#### 7. f(x) = x^4 − 5, con x0 = 1, x1 = 2

```{r}
f <- function(x) {
  return(x^4 - 5)
}

secante <- function(f, x0, x1, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    fx0 <- f(x0)
    fx1 <- f(x1)
    
    if(abs(fx1 - fx0) < 1e-12){
      cat("Error: División por cero (f(x1) - f(x0) approx 0)\n")
      return(NA)
    }
    
    x2 <- x1 - fx1 * (x1 - x0) / (fx1 - fx0)
    
    error <- abs(x2 - x1)
    
    x0 <- x1
    x1 <- x2
    
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", x2, "\n")
  cat("Iteraciones:", iter, "\n")
  
  return(x2)
}

x0_val <- 1
x1_val <- 2

raiz_secante <- secante(f, x0_val, x1_val)
```
#### 11. f(x) = sin(x) −x^3, con x0 = 0, x1 = 1

```{r}
f <- function(x) {
  return(sin(x) - x^3)
}

secante <- function(f, x0, x1, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  while(error > tol && iter < iter_max){
    fx0 <- f(x0)
    fx1 <- f(x1)
    
    if(abs(fx1 - fx0) < 1e-12){
      cat("Error: División por cero (f(x1) - f(x0) approx 0)\n")
      return(NA)
    }
    
    x2 <- x1 - fx1 * (x1 - x0) / (fx1 - fx0)
    
    error <- abs(x2 - x1)
    x0 <- x1
    x1 <- x2
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", x2, "\n")
  cat("Iteraciones:", iter, "\n")
  
  return(x2)
}

raiz_secante <- secante(f, x0 = 0, x1 = 1)
```

#### 13. f(x) = (−2x+1.1) sin(5x−π/3), con x0 = 0.05,x1 = 0.35

```{r}
f <- function(x) {
  return((-2 * x + 1.1) * sin(5 * x - pi / 3))
}

secante <- function(f, x0, x1, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    fx0 <- f(x0)
    fx1 <- f(x1)
    
    if(abs(fx1 - fx0) < 1e-12){
      cat("Error: División por cero (f(x1) - f(x0) approx 0)\n")
      return(NA)
    }
    
    x2 <- x1 - fx1 * (x1 - x0) / (fx1 - fx0)
    
    error <- abs(x2 - x1)
    
    
    x0 <- x1
    x1 <- x2
    iter <- iter + 1
  }
  

  cat("Raíz aproximada:", x2, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x2)
}

x0_inicial <- 0.05
x1_inicial <- 0.35

raiz_encontrada <- secante(f, x0_inicial, x1_inicial)
```

### Método de Newton

#### 6. f(x) = x^3 − 2x − 5, [a, b] = [2, 3]

```{r}
newton <- function(f, df, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    x1 <- x0 - f(x0)/df(x0)
    
    
    error <- abs(x1 - x0)
    
    x0 <- x1
    
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", x1, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x1)
}

f <- function(x) x^3 - 2*x - 5

df <- function(x) 3*x^2 - 2

x0_inicial <- 2

resultado <- newton(f, df, x0 = x0_inicial)
```


#### 8. f(x) = cos(x) − 2x, [a, b] = [0, 1]

```{r}
newton <- function(f, df, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    x1 <- x0 - f(x0)/df(x0)
    error <- abs(x1 - x0)
    x0 <- x1
    iter <- iter + 1
  }
  cat("Raíz aproximada:", x1, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x1)
}

f <- function(x) cos(x) - 2*x

df <- function(x) -sin(x) - 2

newton(f, df, x0 = 0.5)
```

#### 10. f(x) = xe^−x − 0.1, [a, b] = [0, 1]

```{r}
newton <- function(f, df, x0, tol = 1e-6, iter_max = 100){
iter <- 0
error <- 1
while(error > tol && iter < iter_max){
  
if(df(x0) == 0){
cat("Error: Derivada cero en la iteración", iter, "\n")
return(NA)
}
x1 <- x0 - f(x0)/df(x0)
error <- abs(x1 - x0)
x0 <- x1
iter <- iter + 1
}
cat("Raíz aproximada:", x1, "\n")
cat("Iteraciones:", iter, "\n")
return(x1)
}

f <- function(x) x * exp(-x) - 0.1

df <- function(x) exp(-x) * (1 - x)

newton(f, df, x0 = 0.5)
```

#### 12. f(x) = ex − 3x^2, [a, b] = [0, 1]

```{r}
newton <- function(f, df, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    
    if(abs(df(x0)) < 1e-10){
      cat("Error: Derivada cercana a cero en x =", x0, "\n")
      return(NA)
    }
    
    
    x1 <- x0 - f(x0)/df(x0)
    
    
    error <- abs(x1 - x0)
    
    x0 <- x1
    
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", x0, "\n")
  cat("Iteraciones:", iter, "\n")
  
  return(x0)
}

f <- function(x) exp(x) - 3*x^2

df <- function(x) exp(x) - 6*x

newton(f, df, x0 = 0.5)
```

#### 14. f(x) = x^3 + 4x^2 − 10, [a, b] = [1, 2]

```{r}
newton <- function(f, df, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  
  x_actual <- x0
  
  while(error > tol && iter < iter_max){
    
    if(df(x_actual) == 0){
      cat("Error: La derivada se hizo cero. El método falla.\n")
      return(NA)
    }
    
    x_nuevo <- x_actual - f(x_actual)/df(x_actual)
    
    error <- abs(x_nuevo - x_actual)
    
    x_actual <- x_nuevo
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", x_actual, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x_actual)
}

f <- function(x) x^3 + 4*x^2 - 10

df <- function(x) 3*x^2 + 8*x

newton(f, df, x0 = 1.5)
```


### Metodo del Punto Fijo 

#### 7. f(x) = ln(x + 1) + x − 2, Sugerencia: g(x) = 2 − ln(x + 1), x0 = 0.5

```{r}
fijo <- function(g, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    x1 <- g(x0)
    error <- abs(x1 - x0)
    x0 <- x1
    iter <- iter + 1
  }
  
  cat("Raíz aproximada:", x1, "\n")
  cat("Iteraciones:", iter, "\n")
  
  return(x1)
}

g_ejercicio <- function(x) 2 - log(x + 1)

x0_ejercicio <- 0.5

raíz <- fijo(g_ejercicio, x0 = x0_ejercicio)
```

#### 8. f(x) = x^3 − 3x + 1, Sugerencia: g(x) = √33x − 1, x0 = 0.8

```{r}
fijo <- function(g, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1

  x1 <- x0 
  
  while(error > tol && iter < iter_max){
    x1 <- g(x0)
    error <- abs(x1 - x0)
    x0 <- x1
    iter <- iter + 1
  }
  
  if (iter >= iter_max && error > tol) {
    cat(" Advertencia: No se alcanzó la tolerancia. Máximo de iteraciones alcanzado.\n")
  }
  
  cat("Raíz aproximada:", x1, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x1)
}

g_ejercicio <- function(x) (3 * x - 1)^(1/3)


x0_ejercicio <- 0.8 
tol_ejercicio <- 1e-6 

resultado <- fijo(g_ejercicio, x0 = x0_ejercicio, tol = tol_ejercicio)
```

#### 9. f(x) = x − sin(x) − 1, Sugerencia: g(x) = sin(x) + 1, x0 = 1

```{r}
fijo <- function(g, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  
  while(error > tol && iter < iter_max){
    x1 <- g(x0)      
    error <- abs(x1 - x0) 
    x0 <- x1        
    iter <- iter + 1 
  }
  
  
  cat("--- Método del Punto Fijo ---\n")
  cat("Función de iteración g(x): sin(x) + 1\n")
  cat("Valor inicial (x0):", x0, "\n")
  cat("Raíz aproximada:", x1, "\n")
  cat("Iteraciones:", iter, "\n")
  cat("Error final:", error, "\n")
  
  return(x1)
}

g_ejercicio9 <- function(x) sin(x) + 1

x0_ejercicio9 <- 1
tolerancia <- 1e-6
max_iter <- 100

resultado <- fijo(g_ejercicio9, x0 = x0_ejercicio9, tol = tolerancia, iter_max = max_iter)
```

#### 10. f(x) = x^2 − 3, Sugerencia: g(x) = 3/x, x0 = 1.5

```{r}
fijo <- function(g, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  x1 <- x0 
  
  while(error > tol && iter < iter_max){
    x1_prev <- x1 
    x1 <- g(x0)
    error <- abs(x1 - x0)
    x0 <- x1 
    iter <- iter + 1
  }
  
  if(iter >= iter_max && error > tol){
    cat(" El método no convergió después de", iter_max, "iteraciones. \n")
  }
  
  cat("Raíz aproximada:", x1, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x1)
}

g <- function(x) 3/x

raiz_aprox <- fijo(g, x0 = 1.5)
```

#### 14. f(x) = x − e−x^2, Sugerencia: g(x) = e−x^2, x0 = 0.5

```{r}
fijo <- function(g, x0, tol = 1e-6, iter_max = 100){
  iter <- 0
  error <- 1
  while(error > tol && iter < iter_max){
    x1 <- g(x0)
    error <- abs(x1 - x0)
    x0 <- x1
    iter <- iter + 1
  }
  cat("Raíz aproximada:", x1, "\n")
  cat("Iteraciones:", iter, "\n")
  return(x1)
}

g_ejercicio14 <- function(x) exp(-x^2)

fijo(g_ejercicio14, x0 = 0.5)
```

# Solucion numerica de ecuaciones diferenciales

# Practicas de laboratorio

# Revision de programas

# Mis notas

